void orient_princ(t_atoms *atoms,int isize,atom_id *index,
		  int natoms, rvec x[], rvec *v, rvec d)
{
  int     m;
  rvec    xcm,prcomp;
  matrix  trans;
  
  principal_comp(isize,index,atoms->atom,x,trans,prcomp);
  if (d) 
    copy_rvec(prcomp, d);
  
  /* Check whether this trans matrix mirrors the molecule */
  if (det(trans) < 0) {
    for(m=0; (m<DIM); m++)
      trans[ZZ][m] = -trans[ZZ][m];
  }  
  rotate_atoms(natoms,NULL,x,trans);
  if (v) rotate_atoms(natoms,NULL,v,trans);
  
  add_xcm(x,natoms,NULL,xcm);
}
