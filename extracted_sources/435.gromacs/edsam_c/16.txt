void rotate_vec(int nr,rvec *x,matrix rotmat)
{
  int i,j,k;
  rvec xdum;

  /* apply the rotation matrix */
  for(i=0;(i<nr);i++) {
    for(j=0;(j<3);j++)
      xdum[j]=x[i][j];
    for(j=0;(j<3);j++) {
      x[i][j]=0;
      for(k=0;(k<3);k++)
        x[i][j]+=rotmat[k][j]*xdum[k];
    }
  }
}
