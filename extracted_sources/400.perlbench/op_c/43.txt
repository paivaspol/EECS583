OP*
Perl_block_end(pTHX_ I32 floor, OP *seq)
{
    int needblockscope = PL_hints & HINT_BLOCK_SCOPE;
    OP* retval = scalarseq(seq);
    /* If there were syntax errors, don't try to close a block */
    if (PL_yynerrs) return retval;
    LEAVE_SCOPE(floor);
    PL_compiling.op_private = (U8)(PL_hints & HINT_PRIVATE_MASK);
    if (needblockscope)
	PL_hints |= HINT_BLOCK_SCOPE; /* propagate out */
    pad_leavemy();
    return retval;
}
