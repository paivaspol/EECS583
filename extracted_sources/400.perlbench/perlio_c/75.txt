IV
PerlIOUnix_seek(pTHX_ PerlIO *f, Off_t offset, int whence)
{
    int fd = PerlIOSelf(f, PerlIOUnix)->fd;
    Off_t new_loc;
    if (PerlIOBase(f)->flags & PERLIO_F_NOTREG) {
#ifdef  ESPIPE
	SETERRNO(ESPIPE, LIB_INVARG);
#else
	SETERRNO(EINVAL, LIB_INVARG);
#endif
	return -1;
    }
    new_loc = PerlLIO_lseek(fd, offset, whence);
    if (new_loc == (Off_t) - 1)
     {
      return -1;
     }
    PerlIOBase(f)->flags &= ~PERLIO_F_EOF;
    return  0;
}
