define internal fastcc i32 @constrain_lincs(%struct.t_topology* nocapture %top, %struct.t_inputrec* nocapture %ir, i32 %step, %struct.t_mdatoms* nocapture %md, i32 %start, i32 %homenr, [3 x float]* %x, [3 x float]* %xprime, [3 x float]* %min_proj, float %lambda, float* nocapture %dvdlambda, i32 %bCoordinates, i32 %bInit, %struct.t_nrnb* nocapture %nrnb) #0 {
entry:
  %buf = alloca [4096 x i8], align 16
  %warn = alloca i32, align 4
  %p_imax = alloca i32, align 4
  %p_max = alloca float, align 4
  %p_rms = alloca float, align 4
  %0 = getelementptr inbounds [4096 x i8]* %buf, i64 0, i64 0
  call void @llvm.lifetime.start(i64 4096, i8* %0) #2
  %tobool = icmp eq i32 %bInit, 0
  br i1 %tobool, label %if.else, label %if.then

if.then:                                          ; preds = %entry
  %nr = getelementptr inbounds %struct.t_topology* %top, i64 0, i32 1, i32 5, i64 27, i32 0
  %1 = load i32* %nr, align 4, !tbaa !0
  %div = sdiv i32 %1, 3
  store i32 %div, i32* @constrain_lincs.nc, align 4, !tbaa !0
  %2 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %3 = load i32* %nr, align 4, !tbaa !0
  %div.i = sdiv i32 %3, 3
  store i32 0, i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %cmp.i = icmp sgt i32 %3, 2
  br i1 %cmp.i, label %for.body.lr.ph.i, label %if.end192

for.body.lr.ph.i:                                 ; preds = %if.then
  %iatoms.i = getelementptr inbounds %struct.t_topology* %top, i64 0, i32 1, i32 5, i64 27, i32 2
  %4 = load i32** %iatoms.i, align 8, !tbaa !3
  %call.i = call i8* @save_calloc(i8* getelementptr inbounds ([5 x i8]* @.str33, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 131, i32 %homenr, i32 8) #6
  %5 = bitcast i8* %call.i to i32**
  %call5.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str34, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 132, i32 %homenr, i32 4) #6
  %6 = bitcast i8* %call5.i to i32*
  %call6.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str35, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 133, i32 %homenr, i32 4) #6
  %7 = bitcast i8* %call6.i to i32*
  br label %for.body.i

for.body.i:                                       ; preds = %if.end60.i, %for.body.lr.ph.i
  %indvars.iv33.i = phi i64 [ 0, %for.body.lr.ph.i ], [ %indvars.iv.next34.i, %if.end60.i ]
  %8 = trunc i64 %indvars.iv33.i to i32
  %mul.i = mul nsw i32 %8, 3
  %add.i = add nsw i32 %mul.i, 1
  %idxprom.i = sext i32 %add.i to i64
  %arrayidx8.i = getelementptr inbounds i32* %4, i64 %idxprom.i
  %9 = load i32* %arrayidx8.i, align 4, !tbaa !0
  %sub.i = sub nsw i32 %9, %start
  %add10.i = add nsw i32 %mul.i, 2
  %idxprom11.i = sext i32 %add10.i to i64
  %arrayidx12.i = getelementptr inbounds i32* %4, i64 %idxprom11.i
  %10 = load i32* %arrayidx12.i, align 4, !tbaa !0
  %sub13.i = sub nsw i32 %10, %start
  %idxprom14.i = sext i32 %sub.i to i64
  %arrayidx15.i = getelementptr inbounds i32* %6, i64 %idxprom14.i
  %11 = load i32* %arrayidx15.i, align 4, !tbaa !0
  %arrayidx17.i = getelementptr inbounds i32* %7, i64 %idxprom14.i
  %12 = load i32* %arrayidx17.i, align 4, !tbaa !0
  %cmp18.i = icmp slt i32 %11, %12
  br i1 %cmp18.i, label %for.body.if.end_crit_edge.i, label %if.then19.i

for.body.if.end_crit_edge.i:                      ; preds = %for.body.i
  %arrayidx36.phi.trans.insert.i = getelementptr inbounds i32** %5, i64 %idxprom14.i
  %.pre41.i = load i32** %arrayidx36.phi.trans.insert.i, align 8, !tbaa !3
  br label %if.end.i

if.then19.i:                                      ; preds = %for.body.i
  %add22.i = add nsw i32 %12, 4
  store i32 %add22.i, i32* %arrayidx17.i, align 4, !tbaa !0
  %arrayidx24.i = getelementptr inbounds i32** %5, i64 %idxprom14.i
  %13 = load i32** %arrayidx24.i, align 8, !tbaa !3
  %14 = bitcast i32* %13 to i8*
  %mul27.i = shl i32 %add22.i, 2
  %call29.i = call i8* @save_realloc(i8* getelementptr inbounds ([9 x i8]* @.str36, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 140, i8* %14, i32 %mul27.i) #6
  %15 = bitcast i8* %call29.i to i32*
  store i32* %15, i32** %arrayidx24.i, align 8, !tbaa !3
  %.pre38.i = load i32* %arrayidx15.i, align 4, !tbaa !0
  br label %if.end.i

if.end.i:                                         ; preds = %if.then19.i, %for.body.if.end_crit_edge.i
  %16 = phi i32* [ %.pre41.i, %for.body.if.end_crit_edge.i ], [ %15, %if.then19.i ]
  %17 = phi i32 [ %11, %for.body.if.end_crit_edge.i ], [ %.pre38.i, %if.then19.i ]
  %idxprom34.i = sext i32 %17 to i64
  %arrayidx37.i = getelementptr inbounds i32* %16, i64 %idxprom34.i
  store i32 %8, i32* %arrayidx37.i, align 4, !tbaa !0
  %18 = load i32* %arrayidx15.i, align 4, !tbaa !0
  %inc.i = add nsw i32 %18, 1
  store i32 %inc.i, i32* %arrayidx15.i, align 4, !tbaa !0
  %idxprom40.i = sext i32 %sub13.i to i64
  %arrayidx41.i = getelementptr inbounds i32* %6, i64 %idxprom40.i
  %19 = load i32* %arrayidx41.i, align 4, !tbaa !0
  %arrayidx43.i = getelementptr inbounds i32* %7, i64 %idxprom40.i
  %20 = load i32* %arrayidx43.i, align 4, !tbaa !0
  %cmp44.i = icmp slt i32 %19, %20
  br i1 %cmp44.i, label %if.end.if.end60_crit_edge.i, label %if.then46.i

if.end.if.end60_crit_edge.i:                      ; preds = %if.end.i
  %arrayidx65.phi.trans.insert.i = getelementptr inbounds i32** %5, i64 %idxprom40.i
  %.pre42.i = load i32** %arrayidx65.phi.trans.insert.i, align 8, !tbaa !3
  br label %if.end60.i

if.then46.i:                                      ; preds = %if.end.i
  %add49.i = add nsw i32 %20, 4
  store i32 %add49.i, i32* %arrayidx43.i, align 4, !tbaa !0
  %arrayidx51.i = getelementptr inbounds i32** %5, i64 %idxprom40.i
  %21 = load i32** %arrayidx51.i, align 8, !tbaa !3
  %22 = bitcast i32* %21 to i8*
  %mul55.i = shl i32 %add49.i, 2
  %call57.i = call i8* @save_realloc(i8* getelementptr inbounds ([9 x i8]* @.str37, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 146, i8* %22, i32 %mul55.i) #6
  %23 = bitcast i8* %call57.i to i32*
  store i32* %23, i32** %arrayidx51.i, align 8, !tbaa !3
  %.pre39.i = load i32* %arrayidx41.i, align 4, !tbaa !0
  br label %if.end60.i

if.end60.i:                                       ; preds = %if.then46.i, %if.end.if.end60_crit_edge.i
  %24 = phi i32* [ %.pre42.i, %if.end.if.end60_crit_edge.i ], [ %23, %if.then46.i ]
  %25 = phi i32 [ %19, %if.end.if.end60_crit_edge.i ], [ %.pre39.i, %if.then46.i ]
  %idxprom63.i = sext i32 %25 to i64
  %arrayidx66.i = getelementptr inbounds i32* %24, i64 %idxprom63.i
  store i32 %8, i32* %arrayidx66.i, align 4, !tbaa !0
  %26 = load i32* %arrayidx41.i, align 4, !tbaa !0
  %inc69.i = add nsw i32 %26, 1
  store i32 %inc69.i, i32* %arrayidx41.i, align 4, !tbaa !0
  %indvars.iv.next34.i = add i64 %indvars.iv33.i, 1
  %27 = trunc i64 %indvars.iv.next34.i to i32
  %cmp7.i = icmp slt i32 %27, %div.i
  br i1 %cmp7.i, label %for.body.i, label %for.body74.lr.ph.i

for.body74.lr.ph.i:                               ; preds = %if.end60.i
  call void @save_free(i8* getelementptr inbounds ([6 x i8]* @.str35, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 151, i8* %call6.i) #6
  %.pre37.i = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  br label %for.body74.i

for.body74.i:                                     ; preds = %for.body74.i, %for.body74.lr.ph.i
  %28 = phi i32 [ %.pre37.i, %for.body74.lr.ph.i ], [ %add91.i, %for.body74.i ]
  %indvars.iv31.i = phi i64 [ 0, %for.body74.lr.ph.i ], [ %indvars.iv.next32.i, %for.body74.i ]
  %29 = trunc i64 %indvars.iv31.i to i32
  %mul75.i = mul nsw i32 %29, 3
  %add76.i = add nsw i32 %mul75.i, 1
  %idxprom77.i = sext i32 %add76.i to i64
  %arrayidx78.i = getelementptr inbounds i32* %4, i64 %idxprom77.i
  %30 = load i32* %arrayidx78.i, align 4, !tbaa !0
  %sub79.i = sub nsw i32 %30, %start
  %add81.i = add nsw i32 %mul75.i, 2
  %idxprom82.i = sext i32 %add81.i to i64
  %arrayidx83.i = getelementptr inbounds i32* %4, i64 %idxprom82.i
  %31 = load i32* %arrayidx83.i, align 4, !tbaa !0
  %sub84.i = sub nsw i32 %31, %start
  %idxprom85.i = sext i32 %sub79.i to i64
  %arrayidx86.i = getelementptr inbounds i32* %6, i64 %idxprom85.i
  %32 = load i32* %arrayidx86.i, align 4, !tbaa !0
  %idxprom87.i = sext i32 %sub84.i to i64
  %arrayidx88.i = getelementptr inbounds i32* %6, i64 %idxprom87.i
  %33 = load i32* %arrayidx88.i, align 4, !tbaa !0
  %add89.i = add i32 %28, -2
  %sub90.i = add i32 %add89.i, %32
  %add91.i = add i32 %sub90.i, %33
  store i32 %add91.i, i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %indvars.iv.next32.i = add i64 %indvars.iv31.i, 1
  %34 = trunc i64 %indvars.iv.next32.i to i32
  %cmp72.i = icmp slt i32 %34, %div.i
  br i1 %cmp72.i, label %for.body74.i, label %for.body115.lr.ph.i

for.body115.lr.ph.i:                              ; preds = %for.body74.i
  %call95.i = call i8* @save_calloc(i8* getelementptr inbounds ([3 x i8]* @.str38, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 159, i32 %div.i, i32 12) #6
  %35 = bitcast i8* %call95.i to [3 x float]*
  store [3 x float]* %35, [3 x float]** @constrain_lincs.r, align 8, !tbaa !3
  %call96.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str39, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 160, i32 %div.i, i32 4) #6
  %36 = bitcast i8* %call96.i to i32*
  store i32* %36, i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %call97.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str40, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 161, i32 %div.i, i32 4) #6
  %37 = bitcast i8* %call97.i to i32*
  store i32* %37, i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %add98.i = add nsw i32 %div.i, 1
  %call99.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str41, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 162, i32 %add98.i, i32 4) #6
  %38 = bitcast i8* %call99.i to i32*
  store i32* %38, i32** @constrain_lincs.blnr, align 8, !tbaa !3
  %call100.i = call i8* @save_calloc(i8* getelementptr inbounds ([7 x i8]* @.str42, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 163, i32 %div.i, i32 4) #6
  %39 = bitcast i8* %call100.i to float*
  store float* %39, float** @constrain_lincs.bllen, align 8, !tbaa !3
  %call101.i = call i8* @save_calloc(i8* getelementptr inbounds ([5 x i8]* @.str43, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 164, i32 %div.i, i32 4) #6
  %40 = bitcast i8* %call101.i to float*
  store float* %40, float** @constrain_lincs.blc, align 8, !tbaa !3
  %call102.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str44, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 165, i32 %div.i, i32 4) #6
  %41 = bitcast i8* %call102.i to float*
  store float* %41, float** @constrain_lincs.tmp1, align 8, !tbaa !3
  %call103.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str45, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 166, i32 %div.i, i32 4) #6
  %42 = bitcast i8* %call103.i to float*
  store float* %42, float** @constrain_lincs.tmp2, align 8, !tbaa !3
  %call104.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str46, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 167, i32 %div.i, i32 4) #6
  %43 = bitcast i8* %call104.i to float*
  store float* %43, float** @constrain_lincs.tmp3, align 8, !tbaa !3
  %call105.i = call i8* @save_calloc(i8* getelementptr inbounds ([10 x i8]* @.str47, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 168, i32 %div.i, i32 4) #6
  %44 = bitcast i8* %call105.i to float*
  store float* %44, float** @constrain_lincs.lincslam, align 8, !tbaa !3
  %call106.i = call i8* @save_calloc(i8* getelementptr inbounds ([8 x i8]* @.str48, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 169, i32 %div.i, i32 4) #6
  %45 = bitcast i8* %call106.i to float*
  store float* %45, float** @constrain_lincs.bllen0, align 8, !tbaa !3
  %call107.i = call i8* @save_calloc(i8* getelementptr inbounds ([7 x i8]* @.str49, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 170, i32 %div.i, i32 4) #6
  %46 = bitcast i8* %call107.i to float*
  store float* %46, float** @constrain_lincs.ddist, align 8, !tbaa !3
  %47 = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %call108.i = call i8* @save_calloc(i8* getelementptr inbounds ([7 x i8]* @.str50, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 171, i32 %47, i32 4) #6
  %48 = bitcast i8* %call108.i to i32*
  store i32* %48, i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  %49 = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %call109.i = call i8* @save_calloc(i8* getelementptr inbounds ([6 x i8]* @.str51, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 172, i32 %49, i32 4) #6
  %50 = bitcast i8* %call109.i to float*
  store float* %50, float** @constrain_lincs.blcc, align 8, !tbaa !3
  %51 = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %call110.i = call i8* @save_calloc(i8* getelementptr inbounds ([5 x i8]* @.str52, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 173, i32 %51, i32 4) #6
  %52 = bitcast i8* %call110.i to float*
  store float* %52, float** @constrain_lincs.blm, align 8, !tbaa !3
  %53 = load i32** @constrain_lincs.blnr, align 8, !tbaa !3
  store i32 0, i32* %53, align 4, !tbaa !0
  %iparams.i = getelementptr inbounds %struct.t_topology* %top, i64 0, i32 1, i32 4
  %invmass.i = getelementptr inbounds %struct.t_mdatoms* %md, i64 0, i32 5
  br label %for.body115.i

for.body115.i:                                    ; preds = %for.end237.i, %for.body115.lr.ph.i
  %indvars.iv29.i = phi i64 [ 0, %for.body115.lr.ph.i ], [ %indvars.iv.next30.i, %for.end237.i ]
  %nZeroLen.014.i = phi i32 [ 0, %for.body115.lr.ph.i ], [ %nZeroLen.1.i, %for.end237.i ]
  %54 = trunc i64 %indvars.iv29.i to i32
  %mul116.i = mul nsw i32 %54, 3
  %add117.i = add nsw i32 %mul116.i, 1
  %idxprom118.i = sext i32 %add117.i to i64
  %arrayidx119.i = getelementptr inbounds i32* %4, i64 %idxprom118.i
  %55 = load i32* %arrayidx119.i, align 4, !tbaa !0
  %add120.i = add nsw i32 %mul116.i, 2
  %idxprom121.i = sext i32 %add120.i to i64
  %arrayidx122.i = getelementptr inbounds i32* %4, i64 %idxprom121.i
  %56 = load i32* %arrayidx122.i, align 4, !tbaa !0
  %idxprom123.i = sext i32 %mul116.i to i64
  %arrayidx124.i = getelementptr inbounds i32* %4, i64 %idxprom123.i
  %57 = load i32* %arrayidx124.i, align 4, !tbaa !0
  %idxprom125.i = sext i32 %57 to i64
  %58 = load %union.t_iparams** %iparams.i, align 8, !tbaa !3
  %dA.i = getelementptr inbounds %union.t_iparams* %58, i64 %idxprom125.i, i32 0, i32 0
  %59 = load float* %dA.i, align 4, !tbaa !4
  %60 = getelementptr inbounds %union.t_iparams* %58, i64 %idxprom125.i, i32 0, i32 1
  %61 = load float* %60, align 4, !tbaa !4
  %conv131.i = fpext float %59 to double
  %cmp132.i = fcmp olt double %conv131.i, 1.200000e-38
  br i1 %cmp132.i, label %land.lhs.true.i, label %lor.lhs.false.i

lor.lhs.false.i:                                  ; preds = %for.body115.i
  %conv134.i = fpext float %61 to double
  %cmp135.i = fcmp olt double %conv134.i, 1.200000e-38
  br i1 %cmp135.i, label %land.lhs.true.i, label %lor.lhs.false.if.end143_crit_edge.i

lor.lhs.false.if.end143_crit_edge.i:              ; preds = %lor.lhs.false.i
  %sub158.pre.i = fsub float %61, %59
  br label %if.end143.i

land.lhs.true.i:                                  ; preds = %lor.lhs.false.i, %for.body115.i
  %sub137.i = fsub float %61, %59
  %fabsf.i = call float @fabsf(float %sub137.i) #7
  %62 = fpext float %fabsf.i to double
  %cmp140.i = fcmp ogt double %62, 1.200000e-38
  br i1 %cmp140.i, label %if.then142.i, label %if.end143.i

if.then142.i:                                     ; preds = %land.lhs.true.i
  call void (i32, i8*, ...)* @fatal_error(i32 0, i8* getelementptr inbounds ([88 x i8]* @.str53, i64 0, i64 0)) #6
  br label %if.end143.i

if.end143.i:                                      ; preds = %if.then142.i, %land.lhs.true.i, %lor.lhs.false.if.end143_crit_edge.i
  %sub158.pre-phi.i = phi float [ %sub158.pre.i, %lor.lhs.false.if.end143_crit_edge.i ], [ %sub137.i, %if.then142.i ], [ %sub137.i, %land.lhs.true.i ]
  %inc148.i = zext i1 %cmp132.i to i32
  %nZeroLen.1.i = add nsw i32 %inc148.i, %nZeroLen.014.i
  %63 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %arrayidx151.i = getelementptr inbounds i32* %63, i64 %indvars.iv29.i
  store i32 %55, i32* %arrayidx151.i, align 4, !tbaa !0
  %64 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %arrayidx153.i = getelementptr inbounds i32* %64, i64 %indvars.iv29.i
  store i32 %56, i32* %arrayidx153.i, align 4, !tbaa !0
  %65 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  %arrayidx155.i = getelementptr inbounds float* %65, i64 %indvars.iv29.i
  store float %59, float* %arrayidx155.i, align 4, !tbaa !4
  %66 = load float** @constrain_lincs.bllen0, align 8, !tbaa !3
  %arrayidx157.i = getelementptr inbounds float* %66, i64 %indvars.iv29.i
  store float %59, float* %arrayidx157.i, align 4, !tbaa !4
  %67 = load float** @constrain_lincs.ddist, align 8, !tbaa !3
  %arrayidx160.i = getelementptr inbounds float* %67, i64 %indvars.iv29.i
  store float %sub158.pre-phi.i, float* %arrayidx160.i, align 4, !tbaa !4
  %idxprom161.i = sext i32 %55 to i64
  %68 = load float** %invmass.i, align 8, !tbaa !3
  %arrayidx162.i = getelementptr inbounds float* %68, i64 %idxprom161.i
  %69 = load float* %arrayidx162.i, align 4, !tbaa !4
  %idxprom163.i = sext i32 %56 to i64
  %arrayidx165.i = getelementptr inbounds float* %68, i64 %idxprom163.i
  %70 = load float* %arrayidx165.i, align 4, !tbaa !4
  %add166.i = fadd float %69, %70
  %conv167.i = fpext float %add166.i to double
  %call168.i = call double @sqrt(double %conv167.i) #6
  %div169.i = fdiv double 1.000000e+00, %call168.i
  %conv170.i = fptrunc double %div169.i to float
  %71 = load float** @constrain_lincs.blc, align 8, !tbaa !3
  %arrayidx172.i = getelementptr inbounds float* %71, i64 %indvars.iv29.i
  store float %conv170.i, float* %arrayidx172.i, align 4, !tbaa !4
  %72 = load i32** @constrain_lincs.blnr, align 8, !tbaa !3
  %arrayidx174.i = getelementptr inbounds i32* %72, i64 %indvars.iv29.i
  %73 = load i32* %arrayidx174.i, align 4, !tbaa !0
  %indvars.iv.next30.i = add i64 %indvars.iv29.i, 1
  %arrayidx177.i = getelementptr inbounds i32* %72, i64 %indvars.iv.next30.i
  store i32 %73, i32* %arrayidx177.i, align 4, !tbaa !0
  %sub179.i = sub nsw i32 %55, %start
  %idxprom180.i = sext i32 %sub179.i to i64
  %arrayidx181.i = getelementptr inbounds i32* %6, i64 %idxprom180.i
  %74 = load i32* %arrayidx181.i, align 4, !tbaa !0
  %cmp1829.i = icmp sgt i32 %74, 0
  br i1 %cmp1829.i, label %for.body184.lr.ph.i, label %for.cond208.loopexit.i

for.body184.lr.ph.i:                              ; preds = %if.end143.i
  %arrayidx188.i = getelementptr inbounds i32** %5, i64 %idxprom180.i
  %75 = load i32** %arrayidx188.i, align 8, !tbaa !3
  %76 = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  br label %for.body184.i

for.body184.i:                                    ; preds = %for.inc205.i, %for.body184.lr.ph.i
  %77 = phi i32 [ %74, %for.body184.lr.ph.i ], [ %80, %for.inc205.i ]
  %indvars.iv25.i = phi i64 [ 0, %for.body184.lr.ph.i ], [ %indvars.iv.next26.i, %for.inc205.i ]
  %arrayidx189.i = getelementptr inbounds i32* %75, i64 %indvars.iv25.i
  %78 = load i32* %arrayidx189.i, align 4, !tbaa !0
  %cmp190.i = icmp eq i32 %78, %54
  br i1 %cmp190.i, label %for.inc205.i, label %if.then192.i

if.then192.i:                                     ; preds = %for.body184.i
  %79 = load i32* %arrayidx177.i, align 4, !tbaa !0
  %inc201.i = add nsw i32 %79, 1
  store i32 %inc201.i, i32* %arrayidx177.i, align 4, !tbaa !0
  %idxprom202.i = sext i32 %79 to i64
  %arrayidx203.i = getelementptr inbounds i32* %76, i64 %idxprom202.i
  store i32 %78, i32* %arrayidx203.i, align 4, !tbaa !0
  %.pre36.i = load i32* %arrayidx181.i, align 4, !tbaa !0
  br label %for.inc205.i

for.inc205.i:                                     ; preds = %if.then192.i, %for.body184.i
  %80 = phi i32 [ %77, %for.body184.i ], [ %.pre36.i, %if.then192.i ]
  %indvars.iv.next26.i = add i64 %indvars.iv25.i, 1
  %81 = trunc i64 %indvars.iv.next26.i to i32
  %cmp182.i = icmp slt i32 %81, %80
  br i1 %cmp182.i, label %for.body184.i, label %for.cond208.loopexit.i

for.cond208.loopexit.i:                           ; preds = %for.inc205.i, %if.end143.i
  %sub209.i = sub nsw i32 %56, %start
  %idxprom210.i = sext i32 %sub209.i to i64
  %arrayidx211.i = getelementptr inbounds i32* %6, i64 %idxprom210.i
  %82 = load i32* %arrayidx211.i, align 4, !tbaa !0
  %cmp21211.i = icmp sgt i32 %82, 0
  br i1 %cmp21211.i, label %for.body214.lr.ph.i, label %for.cond208.loopexit.for.end237_crit_edge.i

for.cond208.loopexit.for.end237_crit_edge.i:      ; preds = %for.cond208.loopexit.i
  %.pre40.i = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  br label %for.end237.i

for.body214.lr.ph.i:                              ; preds = %for.cond208.loopexit.i
  %arrayidx218.i = getelementptr inbounds i32** %5, i64 %idxprom210.i
  %83 = load i32** %arrayidx218.i, align 8, !tbaa !3
  %84 = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  br label %for.body214.i

for.body214.i:                                    ; preds = %for.inc235.i, %for.body214.lr.ph.i
  %85 = phi i32 [ %82, %for.body214.lr.ph.i ], [ %88, %for.inc235.i ]
  %indvars.iv27.i = phi i64 [ 0, %for.body214.lr.ph.i ], [ %indvars.iv.next28.i, %for.inc235.i ]
  %arrayidx219.i = getelementptr inbounds i32* %83, i64 %indvars.iv27.i
  %86 = load i32* %arrayidx219.i, align 4, !tbaa !0
  %cmp220.i = icmp eq i32 %86, %54
  br i1 %cmp220.i, label %for.inc235.i, label %if.then222.i

if.then222.i:                                     ; preds = %for.body214.i
  %87 = load i32* %arrayidx177.i, align 4, !tbaa !0
  %inc231.i = add nsw i32 %87, 1
  store i32 %inc231.i, i32* %arrayidx177.i, align 4, !tbaa !0
  %idxprom232.i = sext i32 %87 to i64
  %arrayidx233.i = getelementptr inbounds i32* %84, i64 %idxprom232.i
  store i32 %86, i32* %arrayidx233.i, align 4, !tbaa !0
  %.pre35.i = load i32* %arrayidx211.i, align 4, !tbaa !0
  br label %for.inc235.i

for.inc235.i:                                     ; preds = %if.then222.i, %for.body214.i
  %88 = phi i32 [ %85, %for.body214.i ], [ %.pre35.i, %if.then222.i ]
  %indvars.iv.next28.i = add i64 %indvars.iv27.i, 1
  %89 = trunc i64 %indvars.iv.next28.i to i32
  %cmp212.i = icmp slt i32 %89, %88
  br i1 %cmp212.i, label %for.body214.i, label %for.end237.i

for.end237.i:                                     ; preds = %for.inc235.i, %for.cond208.loopexit.for.end237_crit_edge.i
  %90 = phi i32* [ %.pre40.i, %for.cond208.loopexit.for.end237_crit_edge.i ], [ %84, %for.inc235.i ]
  %91 = load i32* %arrayidx174.i, align 4, !tbaa !0
  %idxprom240.i = sext i32 %91 to i64
  %arrayidx241.i = getelementptr inbounds i32* %90, i64 %idxprom240.i
  %92 = bitcast i32* %arrayidx241.i to i8*
  %93 = load i32* %arrayidx177.i, align 4, !tbaa !0
  %sub247.i = sub nsw i32 %93, %91
  %conv248.i = sext i32 %sub247.i to i64
  call void @qsort(i8* %92, i64 %conv248.i, i64 4, i32 (i8*, i8*)* @int_comp) #6
  %94 = trunc i64 %indvars.iv.next30.i to i32
  %cmp113.i = icmp slt i32 %94, %div.i
  br i1 %cmp113.i, label %for.body115.i, label %for.end251.i

for.end251.i:                                     ; preds = %for.end237.i
  call void @save_free(i8* getelementptr inbounds ([6 x i8]* @.str34, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 213, i8* %call5.i) #6
  %cmp2537.i = icmp sgt i32 %homenr, 0
  br i1 %cmp2537.i, label %for.body255.i, label %for.end260.i

for.body255.i:                                    ; preds = %for.end251.i, %for.body255.i
  %indvars.iv23.i = phi i64 [ %indvars.iv.next24.i, %for.body255.i ], [ 0, %for.end251.i ]
  %arrayidx257.i = getelementptr inbounds i32** %5, i64 %indvars.iv23.i
  %95 = load i32** %arrayidx257.i, align 8, !tbaa !3
  %96 = bitcast i32* %95 to i8*
  call void @save_free(i8* getelementptr inbounds ([8 x i8]* @.str54, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 215, i8* %96) #6
  %indvars.iv.next24.i = add i64 %indvars.iv23.i, 1
  %lftr.wideiv = trunc i64 %indvars.iv.next24.i to i32
  %exitcond = icmp eq i32 %lftr.wideiv, %homenr
  br i1 %exitcond, label %for.end260.i, label %for.body255.i

for.end260.i:                                     ; preds = %for.body255.i, %for.end251.i
  call void @save_free(i8* getelementptr inbounds ([5 x i8]* @.str33, i64 0, i64 0), i8* getelementptr inbounds ([54 x i8]* @.str4, i64 0, i64 0), i32 216, i8* %call.i) #6
  %tobool.i = icmp eq %struct._IO_FILE* %2, null
  br i1 %tobool.i, label %for.body279.lr.ph.i, label %if.then261.i

if.then261.i:                                     ; preds = %for.end260.i
  %97 = call i64 @fwrite(i8* getelementptr inbounds ([40 x i8]* @.str55, i64 0, i64 0), i64 39, i64 1, %struct._IO_FILE* %2) #2
  %call263.i = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %2, i8* getelementptr inbounds ([31 x i8]* @.str56, i64 0, i64 0), i32 %div.i) #6
  %98 = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %conv264.i = sitofp i32 %98 to float
  %conv265.i = sitofp i32 %div.i to float
  %div266.i = fdiv float %conv264.i, %conv265.i
  %conv267.i = fpext float %div266.i to double
  %call268.i = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %2, i8* getelementptr inbounds ([67 x i8]* @.str57, i64 0, i64 0), double %conv267.i) #6
  %tobool269.i = icmp eq i32 %nZeroLen.1.i, 0
  br i1 %tobool269.i, label %if.end272.i, label %if.then270.i

if.then270.i:                                     ; preds = %if.then261.i
  %call271.i = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %2, i8* getelementptr inbounds ([41 x i8]* @.str58, i64 0, i64 0), i32 %nZeroLen.1.i) #6
  br label %if.end272.i

if.end272.i:                                      ; preds = %if.then270.i, %if.then261.i
  %fputc.i = call i32 @fputc(i32 10, %struct._IO_FILE* %2) #2
  %call274.i = call i32 @fflush(%struct._IO_FILE* %2) #6
  br label %for.body279.lr.ph.i

for.body279.lr.ph.i:                              ; preds = %if.end272.i, %for.end260.i
  %99 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %100 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %101 = load i32** @constrain_lincs.blnr, align 8, !tbaa !3
  %102 = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  %103 = load float** @constrain_lincs.blc, align 8, !tbaa !3
  %104 = load float** @constrain_lincs.blcc, align 8, !tbaa !3
  %.pre.i = load i32* %101, align 4, !tbaa !0
  br label %for.body279.i

for.cond276.loopexit.i:                           ; preds = %if.end317.i, %for.body279.i
  %105 = trunc i64 %indvars.iv.next22.i to i32
  %cmp277.i = icmp slt i32 %105, %div.i
  br i1 %cmp277.i, label %for.body279.i, label %if.end192

for.body279.i:                                    ; preds = %for.cond276.loopexit.i, %for.body279.lr.ph.i
  %106 = phi i32 [ %.pre.i, %for.body279.lr.ph.i ], [ %109, %for.cond276.loopexit.i ]
  %indvars.iv21.i = phi i64 [ 0, %for.body279.lr.ph.i ], [ %indvars.iv.next22.i, %for.cond276.loopexit.i ]
  %arrayidx281.i = getelementptr inbounds i32* %99, i64 %indvars.iv21.i
  %107 = load i32* %arrayidx281.i, align 4, !tbaa !0
  %arrayidx283.i = getelementptr inbounds i32* %100, i64 %indvars.iv21.i
  %108 = load i32* %arrayidx283.i, align 4, !tbaa !0
  %indvars.iv.next22.i = add i64 %indvars.iv21.i, 1
  %arrayidx2892.i = getelementptr inbounds i32* %101, i64 %indvars.iv.next22.i
  %109 = load i32* %arrayidx2892.i, align 4, !tbaa !0
  %cmp2903.i = icmp slt i32 %106, %109
  br i1 %cmp2903.i, label %for.body292.lr.ph.i, label %for.cond276.loopexit.i

for.body292.lr.ph.i:                              ; preds = %for.body279.i
  %110 = load float** %invmass.i, align 8, !tbaa !3
  %arrayidx323.i = getelementptr inbounds float* %103, i64 %indvars.iv21.i
  %111 = sext i32 %106 to i64
  br label %for.body292.i

for.body292.i:                                    ; preds = %if.end317.i, %for.body292.lr.ph.i
  %indvars.iv.i = phi i64 [ %111, %for.body292.lr.ph.i ], [ %indvars.iv.next.i, %if.end317.i ]
  %arrayidx294.i = getelementptr inbounds i32* %102, i64 %indvars.iv.i
  %112 = load i32* %arrayidx294.i, align 4, !tbaa !0
  %idxprom295.i = sext i32 %112 to i64
  %arrayidx296.i = getelementptr inbounds i32* %99, i64 %idxprom295.i
  %113 = load i32* %arrayidx296.i, align 4, !tbaa !0
  %cmp297.i = icmp eq i32 %107, %113
  br i1 %cmp297.i, label %if.end317.i, label %lor.lhs.false310.i

lor.lhs.false310.i:                               ; preds = %for.body292.i
  %arrayidx30145.i = getelementptr inbounds i32* %100, i64 %idxprom295.i
  %114 = load i32* %arrayidx30145.i, align 4, !tbaa !0
  %cmp30246.i = icmp eq i32 %108, %114
  %.47.i = select i1 %cmp30246.i, float -1.000000e+00, float 1.000000e+00
  %cmp313.i = icmp eq i32 %107, %114
  %.1.i = select i1 %cmp313.i, i32 %107, i32 %108
  br label %if.end317.i

if.end317.i:                                      ; preds = %lor.lhs.false310.i, %for.body292.i
  %sign.043.i = phi float [ %.47.i, %lor.lhs.false310.i ], [ -1.000000e+00, %for.body292.i ]
  %cen.0.i = phi i32 [ %.1.i, %lor.lhs.false310.i ], [ %107, %for.body292.i ]
  %idxprom318.i = sext i32 %cen.0.i to i64
  %arrayidx320.i = getelementptr inbounds float* %110, i64 %idxprom318.i
  %115 = load float* %arrayidx320.i, align 4, !tbaa !4
  %mul321.i = fmul float %sign.043.i, %115
  %116 = load float* %arrayidx323.i, align 4, !tbaa !4
  %mul324.i = fmul float %mul321.i, %116
  %arrayidx326.i = getelementptr inbounds float* %103, i64 %idxprom295.i
  %117 = load float* %arrayidx326.i, align 4, !tbaa !4
  %mul327.i = fmul float %mul324.i, %117
  %arrayidx329.i = getelementptr inbounds float* %104, i64 %indvars.iv.i
  store float %mul327.i, float* %arrayidx329.i, align 4, !tbaa !4
  %indvars.iv.next.i = add i64 %indvars.iv.i, 1
  %118 = trunc i64 %indvars.iv.next.i to i32
  %cmp290.i = icmp slt i32 %118, %109
  br i1 %cmp290.i, label %for.body292.i, label %for.cond276.loopexit.i

if.else:                                          ; preds = %entry
  %119 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %cmp = icmp eq i32 %119, 0
  br i1 %cmp, label %if.end192, label %if.then1

if.then1:                                         ; preds = %if.else
  %tobool2 = icmp eq i32 %bCoordinates, 0
  br i1 %tobool2, label %if.else177, label %if.then3

if.then3:                                         ; preds = %if.then1
  %delta_t = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 15
  %120 = load float* %delta_t, align 4, !tbaa !4
  %mul = fmul float %120, %120
  %conv5 = fdiv float 1.000000e+00, %mul
  %efep = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 46
  %121 = load i32* %efep, align 4, !tbaa !0
  %cmp6 = icmp eq i32 %121, 0
  br i1 %cmp6, label %for.cond17.preheader, label %for.cond.preheader

for.cond.preheader:                               ; preds = %if.then3
  %cmp912 = icmp sgt i32 %119, 0
  br i1 %cmp912, label %for.body.lr.ph, label %for.end63

for.body.lr.ph:                                   ; preds = %for.cond.preheader
  %122 = load float** @constrain_lincs.bllen0, align 8, !tbaa !3
  %123 = load float** @constrain_lincs.ddist, align 8, !tbaa !3
  %124 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  br label %for.body

for.cond17.preheader:                             ; preds = %for.body, %if.then3
  %cmp1810 = icmp sgt i32 %119, 0
  br i1 %cmp1810, label %for.body20, label %for.end63

for.body:                                         ; preds = %for.body.lr.ph, %for.body
  %indvars.iv18 = phi i64 [ 0, %for.body.lr.ph ], [ %indvars.iv.next19, %for.body ]
  %arrayidx11 = getelementptr inbounds float* %122, i64 %indvars.iv18
  %125 = load float* %arrayidx11, align 4, !tbaa !4
  %arrayidx13 = getelementptr inbounds float* %123, i64 %indvars.iv18
  %126 = load float* %arrayidx13, align 4, !tbaa !4
  %mul14 = fmul float %126, %lambda
  %add = fadd float %125, %mul14
  %arrayidx16 = getelementptr inbounds float* %124, i64 %indvars.iv18
  store float %add, float* %arrayidx16, align 4, !tbaa !4
  %indvars.iv.next19 = add i64 %indvars.iv18, 1
  %127 = trunc i64 %indvars.iv.next19 to i32
  %cmp9 = icmp slt i32 %127, %119
  br i1 %cmp9, label %for.body, label %for.cond17.preheader

for.body20:                                       ; preds = %for.inc61, %for.cond17.preheader
  %128 = phi i32 [ %119, %for.cond17.preheader ], [ %142, %for.inc61 ]
  %indvars.iv16 = phi i64 [ 0, %for.cond17.preheader ], [ %indvars.iv.next17, %for.inc61 ]
  %129 = load float** @constrain_lincs.bllen0, align 8, !tbaa !3
  %arrayidx22 = getelementptr inbounds float* %129, i64 %indvars.iv16
  %130 = load float* %arrayidx22, align 4, !tbaa !4
  %conv23 = fpext float %130 to double
  %cmp24 = fcmp olt double %conv23, 1.200000e-38
  br i1 %cmp24, label %if.then26, label %for.inc61

if.then26:                                        ; preds = %for.body20
  %131 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %arrayidx28 = getelementptr inbounds i32* %131, i64 %indvars.iv16
  %132 = load i32* %arrayidx28, align 4, !tbaa !0
  %133 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %arrayidx30 = getelementptr inbounds i32* %133, i64 %indvars.iv16
  %134 = load i32* %arrayidx30, align 4, !tbaa !0
  %idxprom31 = sext i32 %132 to i64
  %arrayidx33 = getelementptr inbounds [3 x float]* %x, i64 %idxprom31, i64 0
  %135 = load float* %arrayidx33, align 4, !tbaa !4
  %idxprom34 = sext i32 %134 to i64
  %arrayidx36 = getelementptr inbounds [3 x float]* %x, i64 %idxprom34, i64 0
  %136 = load float* %arrayidx36, align 4, !tbaa !4
  %sub = fsub float %135, %136
  %mul.i2 = fmul float %sub, %sub
  %arrayidx39 = getelementptr inbounds [3 x float]* %x, i64 %idxprom31, i64 1
  %137 = load float* %arrayidx39, align 4, !tbaa !4
  %arrayidx42 = getelementptr inbounds [3 x float]* %x, i64 %idxprom34, i64 1
  %138 = load float* %arrayidx42, align 4, !tbaa !4
  %sub43 = fsub float %137, %138
  %mul.i3 = fmul float %sub43, %sub43
  %add45 = fadd float %mul.i2, %mul.i3
  %arrayidx48 = getelementptr inbounds [3 x float]* %x, i64 %idxprom31, i64 2
  %139 = load float* %arrayidx48, align 4, !tbaa !4
  %arrayidx51 = getelementptr inbounds [3 x float]* %x, i64 %idxprom34, i64 2
  %140 = load float* %arrayidx51, align 4, !tbaa !4
  %sub52 = fsub float %139, %140
  %mul.i4 = fmul float %sub52, %sub52
  %add54 = fadd float %add45, %mul.i4
  %conv57 = call float @sqrtf(float %add54) #3
  %141 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  %arrayidx59 = getelementptr inbounds float* %141, i64 %indvars.iv16
  store float %conv57, float* %arrayidx59, align 4, !tbaa !4
  %.pre20 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  br label %for.inc61

for.inc61:                                        ; preds = %for.body20, %if.then26
  %142 = phi i32 [ %128, %for.body20 ], [ %.pre20, %if.then26 ]
  %indvars.iv.next17 = add i64 %indvars.iv16, 1
  %143 = trunc i64 %indvars.iv.next17 to i32
  %cmp18 = icmp slt i32 %143, %142
  br i1 %cmp18, label %for.body20, label %for.end63

for.end63:                                        ; preds = %for.cond.preheader, %for.inc61, %for.cond17.preheader
  %LincsWarnAngle = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 66
  %144 = load float* %LincsWarnAngle, align 4, !tbaa !4
  %nstlog = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 8
  %145 = load i32* %nstlog, align 4, !tbaa !0
  %call64 = call i32 @do_per_step(i32 %step, i32 %145) #6
  %tobool65 = icmp ne i32 %call64, 0
  %cmp66 = icmp slt i32 %step, 0
  %or.cond = or i1 %tobool65, %cmp66
  br i1 %or.cond, label %if.then68, label %if.end69

if.then68:                                        ; preds = %for.end63
  %146 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %147 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %148 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %149 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  call void @cconerr(float* %p_max, float* %p_rms, i32* %p_imax, [3 x float]* %xprime, i32 %146, i32* %147, i32* %148, float* %149) #5
  br label %if.end69

if.end69:                                         ; preds = %for.end63, %if.then68
  %eI = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 0
  %150 = load i32* %eI, align 4, !tbaa !0
  %.off = add i32 %150, -1
  %switch = icmp ult i32 %.off, 2
  %nProjOrder = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 65
  %151 = load i32* %nProjOrder, align 4, !tbaa !0
  %. = select i1 %switch, i32 %151, i32 1
  %152 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %153 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %154 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %155 = load i32** @constrain_lincs.blnr, align 8, !tbaa !3
  %156 = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  %157 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  %158 = load float** @constrain_lincs.blc, align 8, !tbaa !3
  %159 = load float** @constrain_lincs.blcc, align 8, !tbaa !3
  %160 = load float** @constrain_lincs.blm, align 8, !tbaa !3
  %invmass = getelementptr inbounds %struct.t_mdatoms* %md, i64 0, i32 5
  %161 = load float** %invmass, align 8, !tbaa !3
  %162 = load [3 x float]** @constrain_lincs.r, align 8, !tbaa !3
  %163 = load float** @constrain_lincs.tmp1, align 8, !tbaa !3
  %164 = load float** @constrain_lincs.tmp2, align 8, !tbaa !3
  %165 = load float** @constrain_lincs.tmp3, align 8, !tbaa !3
  %166 = load float** @constrain_lincs.lincslam, align 8, !tbaa !3
  call void @clincs([3 x float]* %x, [3 x float]* %xprime, i32 %152, i32* %153, i32* %154, i32* %155, i32* %156, float* %157, float* %158, float* %159, float* %160, i32 %., i32 %151, float* %161, [3 x float]* %162, float* %163, float* %164, float* %165, float %144, i32* %warn, float* %166) #6
  %167 = load i32* %efep, align 4, !tbaa !0
  %cmp83 = icmp eq i32 %167, 0
  br i1 %cmp83, label %if.end101, label %for.cond86.preheader

for.cond86.preheader:                             ; preds = %if.end69
  %168 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %cmp877 = icmp sgt i32 %168, 0
  br i1 %cmp877, label %for.body89.lr.ph, label %for.end99

for.body89.lr.ph:                                 ; preds = %for.cond86.preheader
  %169 = load float** @constrain_lincs.lincslam, align 8, !tbaa !3
  %170 = load float** @constrain_lincs.ddist, align 8, !tbaa !3
  br label %for.body89

for.body89:                                       ; preds = %for.body89.lr.ph, %for.body89
  %indvars.iv14 = phi i64 [ 0, %for.body89.lr.ph ], [ %indvars.iv.next15, %for.body89 ]
  %dvdl.09 = phi float [ 0.000000e+00, %for.body89.lr.ph ], [ %add96, %for.body89 ]
  %arrayidx91 = getelementptr inbounds float* %169, i64 %indvars.iv14
  %171 = load float* %arrayidx91, align 4, !tbaa !4
  %mul92 = fmul float %conv5, %171
  %arrayidx94 = getelementptr inbounds float* %170, i64 %indvars.iv14
  %172 = load float* %arrayidx94, align 4, !tbaa !4
  %mul95 = fmul float %mul92, %172
  %add96 = fadd float %dvdl.09, %mul95
  %indvars.iv.next15 = add i64 %indvars.iv14, 1
  %173 = trunc i64 %indvars.iv.next15 to i32
  %cmp87 = icmp slt i32 %173, %168
  br i1 %cmp87, label %for.body89, label %for.end99

for.end99:                                        ; preds = %for.body89, %for.cond86.preheader
  %dvdl.0.lcssa = phi float [ 0.000000e+00, %for.cond86.preheader ], [ %add96, %for.body89 ]
  %174 = load float* %dvdlambda, align 4, !tbaa !4
  %add100 = fadd float %dvdl.0.lcssa, %174
  store float %add100, float* %dvdlambda, align 4, !tbaa !4
  br label %if.end101

if.end101:                                        ; preds = %if.end69, %for.end99
  %175 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %tobool102 = icmp eq %struct._IO_FILE* %175, null
  br i1 %tobool102, label %if.end131, label %if.then103

if.then103:                                       ; preds = %if.end101
  %176 = load i32* %nstlog, align 4, !tbaa !0
  %call105 = call i32 @do_per_step(i32 %step, i32 %176) #6
  %tobool106 = icmp ne i32 %call105, 0
  %or.cond194 = or i1 %tobool106, %cmp66
  br i1 %or.cond194, label %if.then110, label %if.end131

if.then110:                                       ; preds = %if.then103
  %177 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %178 = call i64 @fwrite(i8* getelementptr inbounds ([61 x i8]* @.str28, i64 0, i64 0), i64 60, i64 1, %struct._IO_FILE* %177)
  %179 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %180 = load float* %p_max, align 4, !tbaa !4
  %conv112 = fpext float %180 to double
  %181 = load i32* %p_imax, align 4, !tbaa !0
  %idxprom113 = sext i32 %181 to i64
  %182 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %arrayidx114 = getelementptr inbounds i32* %182, i64 %idxprom113
  %183 = load i32* %arrayidx114, align 4, !tbaa !0
  %add115 = add nsw i32 %183, 1
  %184 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %arrayidx117 = getelementptr inbounds i32* %184, i64 %idxprom113
  %185 = load i32* %arrayidx117, align 4, !tbaa !0
  %add118 = add nsw i32 %185, 1
  %186 = load float* %p_rms, align 4, !tbaa !4
  %conv119 = fpext float %186 to double
  %call120 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %179, i8* getelementptr inbounds ([49 x i8]* @.str29, i64 0, i64 0), double %conv112, i32 %add115, i32 %add118, double %conv119) #6
  %187 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %188 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %189 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %190 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  call void @cconerr(float* %p_max, float* %p_rms, i32* %p_imax, [3 x float]* %xprime, i32 %187, i32* %188, i32* %189, float* %190) #5
  %191 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %192 = load float* %p_max, align 4, !tbaa !4
  %conv121 = fpext float %192 to double
  %193 = load i32* %p_imax, align 4, !tbaa !0
  %idxprom122 = sext i32 %193 to i64
  %194 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %arrayidx123 = getelementptr inbounds i32* %194, i64 %idxprom122
  %195 = load i32* %arrayidx123, align 4, !tbaa !0
  %add124 = add nsw i32 %195, 1
  %196 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %arrayidx126 = getelementptr inbounds i32* %196, i64 %idxprom122
  %197 = load i32* %arrayidx126, align 4, !tbaa !0
  %add127 = add nsw i32 %197, 1
  %198 = load float* %p_rms, align 4, !tbaa !4
  %conv128 = fpext float %198 to double
  %call129 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %191, i8* getelementptr inbounds ([50 x i8]* @.str30, i64 0, i64 0), double %conv121, i32 %add124, i32 %add127, double %conv128) #6
  br label %if.end131

if.end131:                                        ; preds = %if.end101, %if.then110, %if.then103
  %199 = load i32* %warn, align 4, !tbaa !0
  %cmp132 = icmp sgt i32 %199, 0
  br i1 %cmp132, label %if.then134, label %if.end160

if.then134:                                       ; preds = %if.end131
  %200 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %tobool136 = icmp eq %struct._IO_FILE* %200, null
  br i1 %tobool136, label %if.then134.if.end156_crit_edge, label %if.then137

if.then134.if.end156_crit_edge:                   ; preds = %if.then134
  %.pre22 = load float* %p_max, align 4, !tbaa !4
  br label %if.end156

if.then137:                                       ; preds = %if.then134
  %201 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %202 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %203 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %204 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  call void @cconerr(float* %p_max, float* %p_rms, i32* %p_imax, [3 x float]* %xprime, i32 %201, i32* %202, i32* %203, float* %204) #5
  %init_t = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 14
  %205 = load float* %init_t, align 4, !tbaa !4
  %conv138 = sitofp i32 %step to float
  %206 = load float* %delta_t, align 4, !tbaa !4
  %mul140 = fmul float %conv138, %206
  %add141 = fadd float %205, %mul140
  %conv142 = fpext float %add141 to double
  %207 = load float* %p_max, align 4, !tbaa !4
  %conv143 = fpext float %207 to double
  %208 = load i32* %p_imax, align 4, !tbaa !0
  %idxprom144 = sext i32 %208 to i64
  %209 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %arrayidx145 = getelementptr inbounds i32* %209, i64 %idxprom144
  %210 = load i32* %arrayidx145, align 4, !tbaa !0
  %add146 = add nsw i32 %210, 1
  %211 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %arrayidx148 = getelementptr inbounds i32* %211, i64 %idxprom144
  %212 = load i32* %arrayidx148, align 4, !tbaa !0
  %add149 = add nsw i32 %212, 1
  %213 = load float* %p_rms, align 4, !tbaa !4
  %conv150 = fpext float %213 to double
  %call151 = call i32 (i8*, i8*, ...)* @sprintf(i8* %0, i8* getelementptr inbounds ([126 x i8]* @.str31, i64 0, i64 0), i32 %step, double %conv142, double %conv143, i32 %add146, i32 %add149, double %conv150) #6
  %214 = load %struct._IO_FILE** @stdlog, align 8, !tbaa !3
  %fputs = call i32 @fputs(i8* %0, %struct._IO_FILE* %214)
  %215 = load %struct._IO_FILE** @stderr, align 8, !tbaa !3
  %fputs1 = call i32 @fputs(i8* %0, %struct._IO_FILE* %215)
  %216 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %217 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %218 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %219 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  call void @lincs_warning([3 x float]* %x, [3 x float]* %xprime, i32 %216, i32* %217, i32* %218, float* %219, float %144) #5
  br label %if.end156

if.end156:                                        ; preds = %if.then134.if.end156_crit_edge, %if.then137
  %220 = phi float [ %.pre22, %if.then134.if.end156_crit_edge ], [ %207, %if.then137 ]
  %cmp158 = fcmp olt float %220, 5.000000e-01
  %conv159 = zext i1 %cmp158 to i32
  br label %if.end160

if.end160:                                        ; preds = %if.end131, %if.end156
  %bOK.0 = phi i32 [ %conv159, %if.end156 ], [ 1, %if.end131 ]
  %221 = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  %cmp1625 = icmp sgt i32 %221, 0
  br i1 %cmp1625, label %for.body164.lr.ph, label %if.end180

for.body164.lr.ph:                                ; preds = %if.end160
  %222 = load float** @constrain_lincs.bllen0, align 8, !tbaa !3
  %223 = load float** @constrain_lincs.bllen, align 8, !tbaa !3
  br label %for.body164

for.body164:                                      ; preds = %for.body164.lr.ph, %for.inc174
  %indvars.iv = phi i64 [ 0, %for.body164.lr.ph ], [ %indvars.iv.next, %for.inc174 ]
  %arrayidx166 = getelementptr inbounds float* %222, i64 %indvars.iv
  %224 = load float* %arrayidx166, align 4, !tbaa !4
  %conv167 = fpext float %224 to double
  %cmp168 = fcmp olt double %conv167, 1.200000e-38
  br i1 %cmp168, label %if.then170, label %for.inc174

if.then170:                                       ; preds = %for.body164
  %arrayidx172 = getelementptr inbounds float* %223, i64 %indvars.iv
  store float 0.000000e+00, float* %arrayidx172, align 4, !tbaa !4
  br label %for.inc174

for.inc174:                                       ; preds = %for.body164, %if.then170
  %indvars.iv.next = add i64 %indvars.iv, 1
  %225 = trunc i64 %indvars.iv.next to i32
  %cmp162 = icmp slt i32 %225, %221
  br i1 %cmp162, label %for.body164, label %if.end180

if.else177:                                       ; preds = %if.then1
  %226 = load i32** @constrain_lincs.bla1, align 8, !tbaa !3
  %227 = load i32** @constrain_lincs.bla2, align 8, !tbaa !3
  %228 = load i32** @constrain_lincs.blnr, align 8, !tbaa !3
  %229 = load i32** @constrain_lincs.blbnb, align 8, !tbaa !3
  %230 = load float** @constrain_lincs.blc, align 8, !tbaa !3
  %231 = load float** @constrain_lincs.blcc, align 8, !tbaa !3
  %232 = load float** @constrain_lincs.blm, align 8, !tbaa !3
  %nProjOrder178 = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 65
  %233 = load i32* %nProjOrder178, align 4, !tbaa !0
  %invmass179 = getelementptr inbounds %struct.t_mdatoms* %md, i64 0, i32 5
  %234 = load float** %invmass179, align 8, !tbaa !3
  %235 = load [3 x float]** @constrain_lincs.r, align 8, !tbaa !3
  %236 = load float** @constrain_lincs.tmp1, align 8, !tbaa !3
  %237 = load float** @constrain_lincs.tmp2, align 8, !tbaa !3
  %238 = load float** @constrain_lincs.tmp3, align 8, !tbaa !3
  call void @clincsp([3 x float]* %x, [3 x float]* %xprime, [3 x float]* %min_proj, i32 %119, i32* %226, i32* %227, i32* %228, i32* %229, float* %230, float* %231, float* %232, i32 %233, float* %234, [3 x float]* %235, float* %236, float* %237, float* %238) #6
  %.pre = load i32* @constrain_lincs.nc, align 4, !tbaa !0
  br label %if.end180

if.end180:                                        ; preds = %if.end160, %for.inc174, %if.else177
  %239 = phi i32 [ %.pre, %if.else177 ], [ %221, %for.inc174 ], [ %221, %if.end160 ]
  %bOK.1 = phi i32 [ 1, %if.else177 ], [ %bOK.0, %for.inc174 ], [ %bOK.0, %if.end160 ]
  %conv181 = sitofp i32 %239 to double
  %arrayidx182 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 113
  %240 = load double* %arrayidx182, align 8, !tbaa !5
  %add183 = fadd double %240, %conv181
  store double %add183, double* %arrayidx182, align 8, !tbaa !5
  %nProjOrder184 = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 65
  %241 = load i32* %nProjOrder184, align 4, !tbaa !0
  %add185 = add nsw i32 %241, 2
  %242 = load i32* @constrain_lincs.nrtot, align 4, !tbaa !0
  %mul186 = mul nsw i32 %add185, %242
  %conv187 = sitofp i32 %mul186 to double
  %arrayidx189 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 114
  %243 = load double* %arrayidx189, align 8, !tbaa !5
  %add190 = fadd double %243, %conv187
  store double %add190, double* %arrayidx189, align 8, !tbaa !5
  br label %if.end192

if.end192:                                        ; preds = %for.cond276.loopexit.i, %if.then, %if.else, %if.end180
  %bOK.2 = phi i32 [ %bOK.1, %if.end180 ], [ 1, %if.else ], [ 1, %if.then ], [ 1, %for.cond276.loopexit.i ]
  call void @llvm.lifetime.end(i64 4096, i8* %0) #2
  ret i32 %bOK.2
}
