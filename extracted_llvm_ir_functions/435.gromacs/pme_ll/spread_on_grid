define %struct.t_fftgrid* @spread_on_grid(%struct.__sFILE* nocapture readnone %logfile, i32 %homenr, i32 %pme_order, [3 x float]* nocapture readonly %x, float* nocapture readonly %charge, [3 x float]* nocapture readonly %box, i32 %bGatherOnly) #1 {
  %nx = alloca i32, align 4
  %ny = alloca i32, align 4
  %nz = alloca i32, align 4
  %la2 = alloca i32, align 4
  %la12 = alloca i32, align 4
  %ptr = alloca float*, align 8
  %1 = load %struct.t_fftgrid** @grid, align 8, !tbaa !2
  call void @unpack_fftgrid(%struct.t_fftgrid* %1, i32* %nx, i32* %ny, i32* %nz, i32* %la2, i32* %la12, i32 1, float** %ptr) #6
  call void @calc_recipbox([3 x float]* %box, [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0)) #8
  %2 = icmp eq i32 %bGatherOnly, 0
  br i1 %2, label %3, label %18

; <label>:3                                       ; preds = %0
  %4 = load [3 x float]** @fractx, align 8, !tbaa !2
  %5 = load [3 x i32]** @idx, align 8, !tbaa !2
  %6 = load i32* %nx, align 4, !tbaa !8
  %7 = load i32* %ny, align 4, !tbaa !8
  %8 = load i32* %nz, align 4, !tbaa !8
  %9 = load i32** @nnx, align 8, !tbaa !2
  %10 = load i32** @nny, align 8, !tbaa !2
  %11 = load i32** @nnz, align 8, !tbaa !2
  call void @calc_idx(i32 %homenr, [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0), [3 x float]* %x, [3 x float]* %4, [3 x i32]* %5, i32 %6, i32 %7, i32 %8, i32* %9, i32* %10, i32* %11) #8
  %12 = load [3 x float]** @fractx, align 8, !tbaa !2
  call void @make_bsplines(float** getelementptr inbounds ([3 x float*]* @theta, i64 0, i64 0), float** getelementptr inbounds ([3 x float*]* @dtheta, i64 0, i64 0), i32 %pme_order, i32 undef, i32 undef, i32 undef, [3 x float]* %12, [3 x i32]* undef, float* %charge, i32 %homenr) #8
  %13 = load %struct.t_fftgrid** @grid, align 8, !tbaa !2
  %14 = load [3 x i32]** @idx, align 8, !tbaa !2
  %15 = load i32** @nnx, align 8, !tbaa !2
  %16 = load i32** @nny, align 8, !tbaa !2
  %17 = load i32** @nnz, align 8, !tbaa !2
  call void @spread_q_bsplines(%struct.t_fftgrid* %13, [3 x i32]* %14, float* %charge, float** getelementptr inbounds ([3 x float*]* @theta, i64 0, i64 0), i32 %homenr, i32 %pme_order, i32* %15, i32* %16, i32* %17) #8
  br label %18

; <label>:18                                      ; preds = %0, %3
  %19 = load %struct.t_fftgrid** @grid, align 8, !tbaa !2
  ret %struct.t_fftgrid* %19
}
