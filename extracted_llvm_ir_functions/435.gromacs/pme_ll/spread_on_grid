define %struct.t_fftgrid* @spread_on_grid(%struct._IO_FILE* nocapture %logfile, i32 %homenr, i32 %pme_order, [3 x float]* nocapture %x, float* nocapture %charge, [3 x float]* nocapture %box, i32 %bGatherOnly) #0 {
entry:
  %nx = alloca i32, align 4
  %ny = alloca i32, align 4
  %nz = alloca i32, align 4
  %la2 = alloca i32, align 4
  %la12 = alloca i32, align 4
  %ptr = alloca float*, align 8
  %0 = load %struct.t_fftgrid** @grid, align 8, !tbaa !0
  call void @unpack_fftgrid(%struct.t_fftgrid* %0, i32* %nx, i32* %ny, i32* %nz, i32* %la2, i32* %la12, i32 1, float** %ptr) #4
  call void @calc_recipbox([3 x float]* %box, [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0)) #6
  %tobool = icmp eq i32 %bGatherOnly, 0
  br i1 %tobool, label %if.then, label %if.end

if.then:                                          ; preds = %entry
  %1 = load [3 x float]** @fractx, align 8, !tbaa !0
  %2 = load [3 x i32]** @idx, align 8, !tbaa !0
  %3 = load i32* %nx, align 4, !tbaa !4
  %4 = load i32* %ny, align 4, !tbaa !4
  %5 = load i32* %nz, align 4, !tbaa !4
  %6 = load i32** @nnx, align 8, !tbaa !0
  %7 = load i32** @nny, align 8, !tbaa !0
  %8 = load i32** @nnz, align 8, !tbaa !0
  call void @calc_idx(i32 %homenr, [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0), [3 x float]* %x, [3 x float]* %1, [3 x i32]* %2, i32 %3, i32 %4, i32 %5, i32* %6, i32* %7, i32* %8) #6
  %9 = load [3 x float]** @fractx, align 8, !tbaa !0
  call void @make_bsplines(float** getelementptr inbounds ([3 x float*]* @theta, i64 0, i64 0), float** getelementptr inbounds ([3 x float*]* @dtheta, i64 0, i64 0), i32 %pme_order, i32 undef, i32 undef, i32 undef, [3 x float]* %9, [3 x i32]* undef, float* %charge, i32 %homenr) #6
  %10 = load %struct.t_fftgrid** @grid, align 8, !tbaa !0
  %11 = load [3 x i32]** @idx, align 8, !tbaa !0
  %12 = load i32** @nnx, align 8, !tbaa !0
  %13 = load i32** @nny, align 8, !tbaa !0
  %14 = load i32** @nnz, align 8, !tbaa !0
  call void @spread_q_bsplines(%struct.t_fftgrid* %10, [3 x i32]* %11, float* %charge, float** getelementptr inbounds ([3 x float*]* @theta, i64 0, i64 0), i32 %homenr, i32 %pme_order, i32* %12, i32* %13, i32* %14) #6
  br label %if.end

if.end:                                           ; preds = %entry, %if.then
  %15 = load %struct.t_fftgrid** @grid, align 8, !tbaa !0
  ret %struct.t_fftgrid* %15
}
