define float @do_pme(%struct.__sFILE* nocapture readnone %logfile, i32 %bVerbose, %struct.t_inputrec* nocapture readonly %ir, [3 x float]* nocapture readonly %x, [3 x float]* nocapture %f, float* nocapture readonly %charge, [3 x float]* nocapture readonly %box, %struct.t_commrec* %cr, %struct.t_nsborder* nocapture readonly %nsb, %struct.t_nrnb* nocapture %nrnb, [3 x float]* nocapture %vir, float %ewaldcoeff, i32 %bGatherOnly) #1 {
  %nx = alloca i32, align 4
  %ny = alloca i32, align 4
  %nz = alloca i32, align 4
  %la12 = alloca i32, align 4
  %la2 = alloca i32, align 4
  %ptr = alloca float*, align 8
  tail call void @llvm.dbg.value(metadata %struct.__sFILE* %logfile, i64 0, metadata !730, metadata !785), !dbg !1908
  tail call void @llvm.dbg.value(metadata i32 %bVerbose, i64 0, metadata !731, metadata !785), !dbg !1909
  tail call void @llvm.dbg.value(metadata %struct.t_inputrec* %ir, i64 0, metadata !732, metadata !785), !dbg !1910
  tail call void @llvm.dbg.value(metadata [3 x float]* %x, i64 0, metadata !733, metadata !785), !dbg !1911
  tail call void @llvm.dbg.value(metadata [3 x float]* %f, i64 0, metadata !734, metadata !785), !dbg !1912
  tail call void @llvm.dbg.value(metadata float* %charge, i64 0, metadata !735, metadata !785), !dbg !1913
  tail call void @llvm.dbg.value(metadata [3 x float]* %box, i64 0, metadata !736, metadata !785), !dbg !1914
  tail call void @llvm.dbg.value(metadata %struct.t_commrec* %cr, i64 0, metadata !737, metadata !785), !dbg !1915
  tail call void @llvm.dbg.value(metadata %struct.t_nsborder* %nsb, i64 0, metadata !738, metadata !785), !dbg !1916
  tail call void @llvm.dbg.value(metadata %struct.t_nrnb* %nrnb, i64 0, metadata !739, metadata !785), !dbg !1917
  tail call void @llvm.dbg.value(metadata [3 x float]* %vir, i64 0, metadata !740, metadata !785), !dbg !1918
  tail call void @llvm.dbg.value(metadata float %ewaldcoeff, i64 0, metadata !741, metadata !785), !dbg !1919
  tail call void @llvm.dbg.value(metadata i32 %bGatherOnly, i64 0, metadata !742, metadata !785), !dbg !1920
  %1 = load %struct.t_fftgrid** @grid, align 8, !dbg !1921, !tbaa !803
  tail call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !746, metadata !785), !dbg !1922
  tail call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !747, metadata !785), !dbg !1923
  tail call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !748, metadata !785), !dbg !1924
  tail call void @llvm.dbg.value(metadata i32* %la12, i64 0, metadata !749, metadata !785), !dbg !1925
  tail call void @llvm.dbg.value(metadata i32* %la2, i64 0, metadata !750, metadata !785), !dbg !1926
  tail call void @llvm.dbg.value(metadata float** %ptr, i64 0, metadata !751, metadata !785), !dbg !1927
  call void @unpack_fftgrid(%struct.t_fftgrid* %1, i32* %nx, i32* %ny, i32* %nz, i32* %la2, i32* %la12, i32 1, float** %ptr) #7, !dbg !1928
  %2 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 0, !dbg !1929
  %3 = load i32* %2, align 4, !dbg !1929, !tbaa !1930
  %4 = sext i32 %3 to i64, !dbg !1929
  %5 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 7, i64 %4, !dbg !1929
  %6 = load i32* %5, align 4, !dbg !1929, !tbaa !943
  %7 = getelementptr inbounds %struct.t_inputrec* %ir, i64 0, i32 20, !dbg !1932
  %8 = load i32* %7, align 4, !dbg !1932, !tbaa !1933
  %9 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 8, i64 %4, !dbg !1936
  %10 = load i32* %9, align 4, !dbg !1936, !tbaa !943
  %11 = sext i32 %10 to i64, !dbg !1937
  %12 = getelementptr inbounds [3 x float]* %x, i64 %11, !dbg !1937
  %13 = getelementptr inbounds float* %charge, i64 %11, !dbg !1938
  %14 = call %struct.t_fftgrid* @spread_on_grid(%struct.__sFILE* undef, i32 %6, i32 %8, [3 x float]* %12, float* %13, [3 x float]* %box, i32 %bGatherOnly) #9, !dbg !1939
  %15 = icmp eq i32 %bGatherOnly, 0, !dbg !1940
  br i1 %15, label %16, label %._crit_edge, !dbg !1942

._crit_edge:                                      ; preds = %0
  %.pre1 = load %struct.t_fftgrid** @grid, align 8, !dbg !1943, !tbaa !803
  br label %110, !dbg !1942

; <label>:16                                      ; preds = %0
  %17 = load i32* %7, align 4, !dbg !1944, !tbaa !1933
  %18 = mul nsw i32 %17, %17, !dbg !1944
  %19 = mul nsw i32 %18, %17, !dbg !1944
  %20 = load i32* %2, align 4, !dbg !1944, !tbaa !1930
  %21 = sext i32 %20 to i64, !dbg !1944
  %22 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 7, i64 %21, !dbg !1944
  %23 = load i32* %22, align 4, !dbg !1944, !tbaa !943
  %24 = mul nsw i32 %19, %23, !dbg !1944
  %25 = sitofp i32 %24 to double, !dbg !1944
  %26 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 81, !dbg !1944
  %27 = load double* %26, align 8, !dbg !1944, !tbaa !1946
  %28 = fadd double %27, %25, !dbg !1944
  store double %28, double* %26, align 8, !dbg !1944, !tbaa !1946
  %29 = getelementptr inbounds %struct.t_commrec* %cr, i64 0, i32 1, !dbg !1948
  %30 = load i32* %29, align 4, !dbg !1948, !tbaa !1087
  %31 = icmp sgt i32 %30, 1, !dbg !1948
  br i1 %31, label %36, label %32, !dbg !1948

; <label>:32                                      ; preds = %16
  %33 = getelementptr inbounds %struct.t_commrec* %cr, i64 0, i32 5, !dbg !1948
  %34 = load i32* %33, align 4, !dbg !1948, !tbaa !1089
  %35 = icmp sgt i32 %34, 1, !dbg !1948
  br i1 %35, label %36, label %37, !dbg !1950

; <label>:36                                      ; preds = %32, %16
  call void @llvm.dbg.value(metadata %struct.t_commrec* undef, i64 0, metadata !273, metadata !785) #6, !dbg !1951
  call void @llvm.dbg.value(metadata %struct.t_nsborder* undef, i64 0, metadata !274, metadata !785) #6, !dbg !1953
  call void @llvm.dbg.value(metadata %struct.t_fftgrid* undef, i64 0, metadata !275, metadata !785) #6, !dbg !1954
  call void @llvm.dbg.value(metadata i32 undef, i64 0, metadata !276, metadata !785) #6, !dbg !1955
  call void (i32, i8*, ...)* @fatal_error(i32 0, i8* getelementptr inbounds ([48 x i8]* @.str1, i64 0, i64 0)) #7, !dbg !1956
  br label %37, !dbg !1957

; <label>:37                                      ; preds = %36, %32
  %38 = load %struct.t_fftgrid** @grid, align 8, !dbg !1958, !tbaa !803
  call void @gmxfft3D(%struct.t_fftgrid* %38, i32 -1, %struct.t_commrec* %cr) #7, !dbg !1959
  tail call void @llvm.dbg.value(metadata [3 x float]* %box, i64 0, metadata !758, metadata !785), !dbg !1960
  %39 = getelementptr inbounds [3 x float]* %box, i64 0, i64 0, !dbg !1962
  %40 = load float* %39, align 4, !dbg !1962, !tbaa !814
  %41 = getelementptr inbounds [3 x float]* %box, i64 1, i64 1, !dbg !1963
  %42 = load float* %41, align 4, !dbg !1963, !tbaa !814
  %43 = getelementptr inbounds [3 x float]* %box, i64 2, i64 2, !dbg !1964
  %44 = load float* %43, align 4, !dbg !1964, !tbaa !814
  %45 = fmul float %42, %44, !dbg !1965
  %46 = getelementptr inbounds [3 x float]* %box, i64 2, i64 1, !dbg !1966
  %47 = load float* %46, align 4, !dbg !1966, !tbaa !814
  %48 = getelementptr inbounds [3 x float]* %box, i64 1, i64 2, !dbg !1967
  %49 = load float* %48, align 4, !dbg !1967, !tbaa !814
  %50 = fmul float %47, %49, !dbg !1968
  %51 = fsub float %45, %50, !dbg !1969
  %52 = fmul float %40, %51, !dbg !1970
  %53 = getelementptr inbounds [3 x float]* %box, i64 1, i64 0, !dbg !1971
  %54 = load float* %53, align 4, !dbg !1971, !tbaa !814
  %55 = getelementptr inbounds [3 x float]* %box, i64 0, i64 1, !dbg !1972
  %56 = load float* %55, align 4, !dbg !1972, !tbaa !814
  %57 = fmul float %44, %56, !dbg !1973
  %58 = getelementptr inbounds [3 x float]* %box, i64 0, i64 2, !dbg !1974
  %59 = load float* %58, align 4, !dbg !1974, !tbaa !814
  %60 = fmul float %47, %59, !dbg !1975
  %61 = fsub float %57, %60, !dbg !1976
  %62 = fmul float %54, %61, !dbg !1977
  %63 = fsub float %52, %62, !dbg !1978
  %64 = getelementptr inbounds [3 x float]* %box, i64 2, i64 0, !dbg !1979
  %65 = load float* %64, align 4, !dbg !1979, !tbaa !814
  %66 = fmul float %49, %56, !dbg !1980
  %67 = fmul float %42, %59, !dbg !1981
  %68 = fsub float %66, %67, !dbg !1982
  %69 = fmul float %65, %68, !dbg !1983
  %70 = fadd float %69, %63, !dbg !1984
  call void @llvm.dbg.value(metadata float %70, i64 0, metadata !752, metadata !785), !dbg !1985
  %71 = load %struct.t_fftgrid** @grid, align 8, !dbg !1986, !tbaa !803
  %72 = call float @solve_pme(%struct.t_fftgrid* %71, float %ewaldcoeff, float %70, float** getelementptr inbounds ([3 x float*]* @bsp_mod, i64 0, i64 0), [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0), [3 x float]* %vir, %struct.t_commrec* %cr) #9, !dbg !1987
  store float %72, float* @do_pme.energy, align 4, !dbg !1988, !tbaa !814
  call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !746, metadata !785), !dbg !1922
  %73 = load i32* %nx, align 4, !dbg !1989, !tbaa !943
  call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !747, metadata !785), !dbg !1923
  %74 = load i32* %ny, align 4, !dbg !1989, !tbaa !943
  %75 = mul nsw i32 %74, %73, !dbg !1989
  call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !748, metadata !785), !dbg !1924
  %76 = load i32* %nz, align 4, !dbg !1989, !tbaa !943
  %77 = mul nsw i32 %75, %76, !dbg !1989
  %78 = sitofp i32 %77 to double, !dbg !1989
  %79 = fmul double %78, 5.000000e-01, !dbg !1989
  %80 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 86, !dbg !1989
  %81 = load double* %80, align 8, !dbg !1989, !tbaa !1946
  %82 = fadd double %81, %79, !dbg !1989
  store double %82, double* %80, align 8, !dbg !1989, !tbaa !1946
  %83 = load %struct.t_fftgrid** @grid, align 8, !dbg !1990, !tbaa !803
  call void @gmxfft3D(%struct.t_fftgrid* %83, i32 1, %struct.t_commrec* %cr) #7, !dbg !1991
  %84 = load i32* %29, align 4, !dbg !1992, !tbaa !1087
  %85 = icmp sgt i32 %84, 1, !dbg !1992
  br i1 %85, label %90, label %86, !dbg !1992

; <label>:86                                      ; preds = %37
  %87 = getelementptr inbounds %struct.t_commrec* %cr, i64 0, i32 5, !dbg !1992
  %88 = load i32* %87, align 4, !dbg !1992, !tbaa !1089
  %89 = icmp sgt i32 %88, 1, !dbg !1992
  br i1 %89, label %90, label %91, !dbg !1994

; <label>:90                                      ; preds = %86, %37
  call void @llvm.dbg.value(metadata %struct.t_commrec* undef, i64 0, metadata !273, metadata !785) #6, !dbg !1995
  call void @llvm.dbg.value(metadata %struct.t_nsborder* undef, i64 0, metadata !274, metadata !785) #6, !dbg !1997
  call void @llvm.dbg.value(metadata %struct.t_fftgrid* undef, i64 0, metadata !275, metadata !785) #6, !dbg !1998
  call void @llvm.dbg.value(metadata i32 undef, i64 0, metadata !276, metadata !785) #6, !dbg !1999
  call void (i32, i8*, ...)* @fatal_error(i32 0, i8* getelementptr inbounds ([48 x i8]* @.str1, i64 0, i64 0)) #7, !dbg !2000
  %.pre = load i32* %29, align 4, !dbg !2001, !tbaa !1087
  br label %91, !dbg !2002

; <label>:91                                      ; preds = %90, %86
  %92 = phi i32 [ %.pre, %90 ], [ %84, %86 ]
  %93 = load %struct.t_fftgrid** @grid, align 8, !dbg !2003, !tbaa !803
  %94 = getelementptr inbounds %struct.t_fftgrid* %93, i64 0, i32 11, !dbg !2004
  %95 = load i32* %94, align 4, !dbg !2004, !tbaa !2005
  call void @llvm.dbg.value(metadata i32 %95, i64 0, metadata !744, metadata !785), !dbg !2007
  %96 = sitofp i32 %95 to double, !dbg !2008
  %97 = sitofp i32 %95 to float, !dbg !2009
  %98 = fpext float %97 to double, !dbg !2009
  %99 = call double @log(double %98) #8, !dbg !2010
  %100 = fmul double %96, %99, !dbg !2011
  %101 = sitofp i32 %92 to double, !dbg !2012
  %102 = fmul double %101, 0x3FE62E42FEFA39EF, !dbg !2013
  %103 = fdiv double %100, %102, !dbg !2014
  %104 = fptosi double %103 to i32, !dbg !2008
  call void @llvm.dbg.value(metadata i32 %104, i64 0, metadata !745, metadata !785), !dbg !2015
  %105 = shl nsw i32 %104, 1, !dbg !2016
  %106 = sitofp i32 %105 to double, !dbg !2016
  %107 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 84, !dbg !2016
  %108 = load double* %107, align 8, !dbg !2016, !tbaa !1946
  %109 = fadd double %108, %106, !dbg !2016
  store double %109, double* %107, align 8, !dbg !2016, !tbaa !1946
  br label %110, !dbg !2017

; <label>:110                                     ; preds = %._crit_edge, %91
  %111 = phi %struct.t_fftgrid* [ %.pre1, %._crit_edge ], [ %93, %91 ]
  %112 = load [3 x i32]** @idx, align 8, !dbg !2018, !tbaa !803
  %113 = load i32* %2, align 4, !dbg !2019, !tbaa !1930
  %114 = sext i32 %113 to i64, !dbg !2019
  %115 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 8, i64 %114, !dbg !2019
  %116 = load i32* %115, align 4, !dbg !2019, !tbaa !943
  %117 = sext i32 %116 to i64, !dbg !2020
  %118 = getelementptr inbounds [3 x float]* %f, i64 %117, !dbg !2020
  %119 = getelementptr inbounds float* %charge, i64 %117, !dbg !2021
  %120 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 7, i64 %114, !dbg !2022
  %121 = load i32* %120, align 4, !dbg !2022, !tbaa !943
  %122 = load i32* %7, align 4, !dbg !2023, !tbaa !1933
  %123 = load i32** @nnx, align 8, !dbg !2024, !tbaa !803
  %124 = load i32** @nny, align 8, !dbg !2025, !tbaa !803
  %125 = load i32** @nnz, align 8, !dbg !2026, !tbaa !803
  call void @gather_f_bsplines(%struct.t_fftgrid* %111, [3 x float]* getelementptr inbounds ([3 x [3 x float]]* @recipbox, i64 0, i64 0), [3 x i32]* %112, [3 x float]* %118, float* %119, float** getelementptr inbounds ([3 x float*]* @theta, i64 0, i64 0), float** getelementptr inbounds ([3 x float*]* @dtheta, i64 0, i64 0), i32 %121, i32 %122, i32* %123, i32* %124, i32* %125) #9, !dbg !2027
  %126 = load i32* %7, align 4, !dbg !2028, !tbaa !1933
  %127 = mul nsw i32 %126, %126, !dbg !2028
  %128 = mul nsw i32 %127, %126, !dbg !2028
  %129 = load i32* %2, align 4, !dbg !2028, !tbaa !1930
  %130 = sext i32 %129 to i64, !dbg !2028
  %131 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 7, i64 %130, !dbg !2028
  %132 = load i32* %131, align 4, !dbg !2028, !tbaa !943
  %133 = mul nsw i32 %128, %132, !dbg !2028
  %134 = sitofp i32 %133 to double, !dbg !2028
  %135 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 83, !dbg !2028
  %136 = load double* %135, align 8, !dbg !2028, !tbaa !1946
  %137 = fadd double %136, %134, !dbg !2028
  store double %137, double* %135, align 8, !dbg !2028, !tbaa !1946
  %138 = load float* @do_pme.energy, align 4, !dbg !2029, !tbaa !814
  ret float %138, !dbg !2030
}
