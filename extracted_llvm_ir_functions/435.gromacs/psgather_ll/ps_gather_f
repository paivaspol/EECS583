define float @ps_gather_f(%struct.__sFILE* nocapture %log, i32 %bVerbose, i32 %natoms, [3 x float]* %x, [3 x float]* nocapture %f, float* nocapture readonly %charge, float* %box, float* nocapture %pot, %struct.t_PSgrid* %grid, float* nocapture readonly %beta, %struct.t_nrnb* nocapture %nrnb) #4 {
  %ixyz = alloca [3 x i32], align 4
  %invh = alloca [3 x float], align 4
  %c1 = alloca [3 x float], align 4
  %c2 = alloca [3 x float], align 4
  %WXYZ = alloca [27 x float], align 16
  %ixw = alloca [7 x i32], align 16
  %iyw = alloca [7 x i32], align 16
  %izw = alloca [7 x i32], align 16
  %nx = alloca i32, align 4
  %ny = alloca i32, align 4
  %nz = alloca i32, align 4
  %ptr = alloca float***, align 8
  tail call void @llvm.dbg.value(metadata %struct.__sFILE* %log, i64 0, metadata !278, metadata !346), !dbg !492
  tail call void @llvm.dbg.value(metadata i32 %bVerbose, i64 0, metadata !279, metadata !346), !dbg !493
  tail call void @llvm.dbg.value(metadata i32 %natoms, i64 0, metadata !280, metadata !346), !dbg !494
  tail call void @llvm.dbg.value(metadata [3 x float]* %x, i64 0, metadata !281, metadata !346), !dbg !495
  tail call void @llvm.dbg.value(metadata [3 x float]* %f, i64 0, metadata !282, metadata !346), !dbg !496
  tail call void @llvm.dbg.value(metadata float* %charge, i64 0, metadata !283, metadata !346), !dbg !497
  tail call void @llvm.dbg.value(metadata float* %box, i64 0, metadata !284, metadata !346), !dbg !498
  tail call void @llvm.dbg.value(metadata float* %pot, i64 0, metadata !285, metadata !346), !dbg !499
  tail call void @llvm.dbg.value(metadata %struct.t_PSgrid* %grid, i64 0, metadata !286, metadata !346), !dbg !500
  tail call void @llvm.dbg.value(metadata float* %beta, i64 0, metadata !287, metadata !346), !dbg !501
  tail call void @llvm.dbg.value(metadata %struct.t_nrnb* %nrnb, i64 0, metadata !288, metadata !346), !dbg !502
  tail call void @llvm.dbg.declare(metadata [3 x i32]* %ixyz, metadata !294, metadata !346), !dbg !503
  tail call void @llvm.dbg.declare(metadata [3 x float]* %invh, metadata !297, metadata !346), !dbg !504
  tail call void @llvm.dbg.declare(metadata [3 x float]* undef, metadata !298, metadata !346), !dbg !505
  tail call void @llvm.dbg.declare(metadata [3 x float]* %c1, metadata !299, metadata !346), !dbg !506
  tail call void @llvm.dbg.declare(metadata [3 x float]* %c2, metadata !300, metadata !346), !dbg !507
  %1 = bitcast [27 x float]* %WXYZ to i8*, !dbg !508
  call void @llvm.lifetime.start(i64 108, i8* %1) #5, !dbg !508
  tail call void @llvm.dbg.declare(metadata [27 x float]* %WXYZ, metadata !301, metadata !346), !dbg !509
  tail call void @llvm.dbg.declare(metadata [7 x i32]* %ixw, metadata !311, metadata !346), !dbg !510
  tail call void @llvm.dbg.declare(metadata [7 x i32]* %iyw, metadata !315, metadata !346), !dbg !511
  tail call void @llvm.dbg.declare(metadata [7 x i32]* %izw, metadata !316, metadata !346), !dbg !512
  tail call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !318, metadata !346), !dbg !513
  tail call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !319, metadata !346), !dbg !514
  tail call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !320, metadata !346), !dbg !515
  tail call void @llvm.dbg.value(metadata float**** %ptr, i64 0, metadata !321, metadata !346), !dbg !516
  call void @unpack_PSgrid(%struct.t_PSgrid* %grid, i32* %nx, i32* %ny, i32* %nz, float**** %ptr) #7, !dbg !517
  call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !318, metadata !346), !dbg !513
  %2 = load i32* %nx, align 4, !dbg !518, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !319, metadata !346), !dbg !514
  %3 = load i32* %ny, align 4, !dbg !519, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !320, metadata !346), !dbg !515
  %4 = load i32* %nz, align 4, !dbg !520, !tbaa !410
  %5 = getelementptr inbounds [3 x float]* %invh, i64 0, i64 0, !dbg !521
  tail call void @llvm.dbg.value(metadata float* %box, i64 0, metadata !326, metadata !346), !dbg !522
  tail call void @llvm.dbg.value(metadata i32 %2, i64 0, metadata !327, metadata !346), !dbg !524
  tail call void @llvm.dbg.value(metadata i32 %3, i64 0, metadata !328, metadata !346), !dbg !525
  tail call void @llvm.dbg.value(metadata i32 %4, i64 0, metadata !329, metadata !346), !dbg !526
  tail call void @llvm.dbg.value(metadata float* %5, i64 0, metadata !330, metadata !346), !dbg !527
  tail call void @llvm.dbg.value(metadata float* undef, i64 0, metadata !331, metadata !346), !dbg !528
  %6 = sitofp i32 %2 to float, !dbg !529
  %7 = load float* %box, align 4, !dbg !530, !tbaa !419
  %8 = fdiv float %6, %7, !dbg !531
  store float %8, float* %5, align 4, !dbg !532, !tbaa !419
  %9 = sitofp i32 %3 to float, !dbg !533
  %10 = getelementptr inbounds float* %box, i64 1, !dbg !534
  %11 = load float* %10, align 4, !dbg !534, !tbaa !419
  %12 = fdiv float %9, %11, !dbg !535
  %13 = getelementptr inbounds [3 x float]* %invh, i64 0, i64 1, !dbg !536
  store float %12, float* %13, align 4, !dbg !537, !tbaa !419
  %14 = sitofp i32 %4 to float, !dbg !538
  %15 = getelementptr inbounds float* %box, i64 2, !dbg !539
  %16 = load float* %15, align 4, !dbg !539, !tbaa !419
  %17 = fdiv float %14, %16, !dbg !540
  %18 = getelementptr inbounds [3 x float]* %invh, i64 0, i64 2, !dbg !541
  store float %17, float* %18, align 4, !dbg !542, !tbaa !419
  call void @llvm.dbg.value(metadata i32 0, i64 0, metadata !290, metadata !346), !dbg !543
  br label %19, !dbg !544

; <label>:19                                      ; preds = %._crit_edge23, %0
  %20 = phi float [ %8, %0 ], [ %.pre, %._crit_edge23 ]
  %indvars.iv20 = phi i64 [ 0, %0 ], [ %indvars.iv.next21, %._crit_edge23 ]
  %21 = getelementptr inbounds float* %beta, i64 %indvars.iv20, !dbg !546
  %22 = load float* %21, align 4, !dbg !546, !tbaa !419
  %23 = fpext float %22 to double, !dbg !546
  %24 = fmul double %23, 5.000000e-01, !dbg !549
  %25 = fpext float %20 to double, !dbg !550
  %26 = fmul double %24, %25, !dbg !551
  %27 = fptrunc double %26 to float, !dbg !552
  %28 = getelementptr inbounds [3 x float]* %c1, i64 0, i64 %indvars.iv20, !dbg !553
  store float %27, float* %28, align 4, !dbg !554, !tbaa !419
  %29 = fsub double 1.000000e+00, %23, !dbg !555
  %30 = fmul double %29, 2.500000e-01, !dbg !556
  %31 = fmul double %25, %30, !dbg !557
  %32 = fptrunc double %31 to float, !dbg !558
  %33 = getelementptr inbounds [3 x float]* %c2, i64 0, i64 %indvars.iv20, !dbg !559
  store float %32, float* %33, align 4, !dbg !560, !tbaa !419
  %indvars.iv.next21 = add nuw nsw i64 %indvars.iv20, 1, !dbg !544
  %exitcond22 = icmp eq i64 %indvars.iv.next21, 3, !dbg !544
  br i1 %exitcond22, label %34, label %._crit_edge23, !dbg !544

._crit_edge23:                                    ; preds = %19
  %.phi.trans.insert = getelementptr inbounds [3 x float]* %invh, i64 0, i64 %indvars.iv.next21
  %.pre = load float* %.phi.trans.insert, align 4, !dbg !550, !tbaa !419
  br label %19, !dbg !544

; <label>:34                                      ; preds = %19
  %ixw6 = bitcast [7 x i32]* %ixw to i8*
  %iyw9 = bitcast [7 x i32]* %iyw to i8*
  %izw13 = bitcast [7 x i32]* %izw to i8*
  %35 = getelementptr inbounds [3 x float]* %c1, i64 0, i64 0, !dbg !561
  %36 = load float* %35, align 4, !dbg !561, !tbaa !419
  call void @llvm.dbg.value(metadata float %36, i64 0, metadata !305, metadata !346), !dbg !562
  %37 = getelementptr inbounds [3 x float]* %c1, i64 0, i64 1, !dbg !563
  %38 = load float* %37, align 4, !dbg !563, !tbaa !419
  call void @llvm.dbg.value(metadata float %38, i64 0, metadata !306, metadata !346), !dbg !564
  %39 = getelementptr inbounds [3 x float]* %c1, i64 0, i64 2, !dbg !565
  %40 = load float* %39, align 4, !dbg !565, !tbaa !419
  call void @llvm.dbg.value(metadata float %40, i64 0, metadata !307, metadata !346), !dbg !566
  %41 = getelementptr inbounds [3 x float]* %c2, i64 0, i64 0, !dbg !567
  %42 = load float* %41, align 4, !dbg !567, !tbaa !419
  call void @llvm.dbg.value(metadata float %42, i64 0, metadata !308, metadata !346), !dbg !568
  %43 = getelementptr inbounds [3 x float]* %c2, i64 0, i64 1, !dbg !569
  %44 = load float* %43, align 4, !dbg !569, !tbaa !419
  call void @llvm.dbg.value(metadata float %44, i64 0, metadata !309, metadata !346), !dbg !570
  %45 = getelementptr inbounds [3 x float]* %c2, i64 0, i64 2, !dbg !571
  %46 = load float* %45, align 4, !dbg !571, !tbaa !419
  call void @llvm.dbg.value(metadata float %46, i64 0, metadata !310, metadata !346), !dbg !572
  %.b = load i1* @ps_gather_f.bFirst, align 1
  br i1 %.b, label %.preheader, label %47, !dbg !573

; <label>:47                                      ; preds = %34
  call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !318, metadata !346), !dbg !513
  call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !319, metadata !346), !dbg !514
  call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !320, metadata !346), !dbg !515
  %48 = call i32 (%struct.__sFILE*, i8*, ...)* @fprintf(%struct.__sFILE* %log, i8* getelementptr inbounds ([57 x i8]* @.str, i64 0, i64 0), i32 %2, i32 %3, i32 %4) #7, !dbg !574
  %49 = load float* %beta, align 4, !dbg !577, !tbaa !419
  %50 = fpext float %49 to double, !dbg !577
  %51 = getelementptr inbounds float* %beta, i64 1, !dbg !578
  %52 = load float* %51, align 4, !dbg !578, !tbaa !419
  %53 = fpext float %52 to double, !dbg !578
  %54 = getelementptr inbounds float* %beta, i64 2, !dbg !579
  %55 = load float* %54, align 4, !dbg !579, !tbaa !419
  %56 = fpext float %55 to double, !dbg !579
  %57 = call i32 (%struct.__sFILE*, i8*, ...)* @fprintf(%struct.__sFILE* %log, i8* getelementptr inbounds ([23 x i8]* @.str1, i64 0, i64 0), double %50, double %53, double %56) #7, !dbg !580
  %58 = fpext float %36 to double, !dbg !581
  %59 = fpext float %38 to double, !dbg !582
  %60 = fpext float %40 to double, !dbg !583
  %61 = call i32 (%struct.__sFILE*, i8*, ...)* @fprintf(%struct.__sFILE* %log, i8* getelementptr inbounds ([23 x i8]* @.str2, i64 0, i64 0), double %58, double %59, double %60) #7, !dbg !584
  %62 = fpext float %42 to double, !dbg !585
  %63 = fpext float %44 to double, !dbg !586
  %64 = fpext float %46 to double, !dbg !587
  %65 = call i32 (%struct.__sFILE*, i8*, ...)* @fprintf(%struct.__sFILE* %log, i8* getelementptr inbounds ([23 x i8]* @.str3, i64 0, i64 0), double %62, double %63, double %64) #7, !dbg !588
  %66 = load float* %5, align 4, !dbg !589, !tbaa !419
  %67 = fpext float %66 to double, !dbg !589
  %68 = load float* %13, align 4, !dbg !590, !tbaa !419
  %69 = fpext float %68 to double, !dbg !590
  %70 = load float* %18, align 4, !dbg !591, !tbaa !419
  %71 = fpext float %70 to double, !dbg !591
  %72 = call i32 (%struct.__sFILE*, i8*, ...)* @fprintf(%struct.__sFILE* %log, i8* getelementptr inbounds ([23 x i8]* @.str4, i64 0, i64 0), double %67, double %69, double %71) #7, !dbg !592
  call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !318, metadata !346), !dbg !513
  %73 = load i32* %nx, align 4, !dbg !593, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !319, metadata !346), !dbg !514
  %74 = load i32* %ny, align 4, !dbg !594, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !320, metadata !346), !dbg !515
  %75 = load i32* %nz, align 4, !dbg !595, !tbaa !410
  call void @calc_nxyz(i32 %73, i32 %74, i32 %75, i32** @ps_gather_f.nnx, i32** @ps_gather_f.nny, i32** @ps_gather_f.nnz) #7, !dbg !596
  call void @llvm.dbg.value(metadata i32 0, i64 0, metadata !289, metadata !346), !dbg !597
  br label %76, !dbg !598

; <label>:76                                      ; preds = %76, %47
  %indvars.iv17 = phi i64 [ 0, %47 ], [ %indvars.iv.next18, %76 ]
  %77 = trunc i64 %indvars.iv17 to i32, !dbg !600
  %78 = sdiv i32 %77, 9, !dbg !600
  %79 = add nsw i32 %78, 2, !dbg !603
  %80 = mul nsw i64 %indvars.iv17, 3, !dbg !604
  %81 = getelementptr inbounds [81 x i32]* @ps_gather_f.JCXYZ, i64 0, i64 %80, !dbg !605
  store i32 %79, i32* %81, align 4, !dbg !606, !tbaa !410
  %82 = sdiv i32 %77, 3, !dbg !607
  %83 = srem i32 %82, 3, !dbg !608
  %84 = add nsw i32 %83, 2, !dbg !609
  %85 = add nuw nsw i64 %80, 1, !dbg !610
  %86 = getelementptr inbounds [81 x i32]* @ps_gather_f.JCXYZ, i64 0, i64 %85, !dbg !611
  store i32 %84, i32* %86, align 4, !dbg !612, !tbaa !410
  %87 = srem i32 %77, 3, !dbg !613
  %88 = add nsw i32 %87, 2, !dbg !614
  %89 = add nuw nsw i64 %80, 2, !dbg !615
  %90 = getelementptr inbounds [81 x i32]* @ps_gather_f.JCXYZ, i64 0, i64 %89, !dbg !616
  store i32 %88, i32* %90, align 4, !dbg !617, !tbaa !410
  %indvars.iv.next18 = add nuw nsw i64 %indvars.iv17, 1, !dbg !598
  %exitcond19 = icmp eq i64 %indvars.iv.next18, 27, !dbg !598
  br i1 %exitcond19, label %91, label %76, !dbg !598

; <label>:91                                      ; preds = %76
  store i1 true, i1* @ps_gather_f.bFirst, align 1
  br label %.preheader, !dbg !618

.preheader:                                       ; preds = %34, %91
  %92 = icmp sgt i32 %natoms, 0, !dbg !619
  br i1 %92, label %.lr.ph, label %133, !dbg !622

.lr.ph:                                           ; preds = %.preheader
  %93 = getelementptr inbounds [3 x i32]* %ixyz, i64 0, i64 0, !dbg !623
  %94 = getelementptr inbounds [27 x float]* %WXYZ, i64 0, i64 0, !dbg !625
  %95 = getelementptr inbounds [3 x i32]* %ixyz, i64 0, i64 1, !dbg !626
  %96 = getelementptr inbounds [3 x i32]* %ixyz, i64 0, i64 2, !dbg !630
  %97 = getelementptr inbounds [7 x i32]* %ixw, i64 0, i64 0, !dbg !631
  %98 = getelementptr inbounds [7 x i32]* %iyw, i64 0, i64 0, !dbg !632
  %99 = getelementptr inbounds [7 x i32]* %izw, i64 0, i64 0, !dbg !633
  %100 = add i32 %natoms, -1, !dbg !622
  br label %101, !dbg !622

; <label>:101                                     ; preds = %101, %.lr.ph
  %indvars.iv = phi i64 [ 0, %.lr.ph ], [ %indvars.iv.next, %101 ]
  %energy.02 = phi float [ 0.000000e+00, %.lr.ph ], [ %131, %101 ]
  call void @llvm.dbg.value(metadata i32* %nx, i64 0, metadata !318, metadata !346), !dbg !513
  %102 = load i32* %nx, align 4, !dbg !634, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %ny, i64 0, metadata !319, metadata !346), !dbg !514
  %103 = load i32* %ny, align 4, !dbg !635, !tbaa !410
  call void @llvm.dbg.value(metadata i32* %nz, i64 0, metadata !320, metadata !346), !dbg !515
  %104 = load i32* %nz, align 4, !dbg !636, !tbaa !410
  %105 = getelementptr inbounds [3 x float]* %x, i64 %indvars.iv, i64 0, !dbg !637
  %106 = trunc i64 %indvars.iv to i32, !dbg !638
  call void @calc_weights(i32 %106, i32 %102, i32 %103, i32 %104, float* %105, float* %box, float* %5, i32* %93, float* %94) #7, !dbg !638
  call void @llvm.dbg.value(metadata i32 -3, i64 0, metadata !317, metadata !346), !dbg !639
  %107 = load i32* %93, align 4, !dbg !640, !tbaa !410
  %108 = load i32* %nx, align 4, !dbg !641, !tbaa !410
  %109 = load i32** @ps_gather_f.nnx, align 8, !dbg !642, !tbaa !429
  %110 = load i32* %95, align 4, !dbg !626, !tbaa !410
  %111 = load i32* %ny, align 4, !dbg !643, !tbaa !410
  %112 = load i32** @ps_gather_f.nny, align 8, !dbg !644, !tbaa !429
  %113 = load i32* %96, align 4, !dbg !630, !tbaa !410
  %114 = load i32* %nz, align 4, !dbg !645, !tbaa !410
  %115 = load i32** @ps_gather_f.nnz, align 8, !dbg !646, !tbaa !429
  %116 = sext i32 %107 to i64
  %117 = sext i32 %108 to i64
  %118 = add nsw i64 %116, %117, !dbg !647
  %scevgep.sum = add nsw i64 %118, -3
  %scevgep7 = getelementptr i32* %109, i64 %scevgep.sum
  %scevgep78 = bitcast i32* %scevgep7 to i8*
  call void @llvm.memcpy.p0i8.p0i8.i64(i8* %ixw6, i8* %scevgep78, i64 28, i32 4, i1 false), !dbg !648
  %119 = sext i32 %110 to i64
  %120 = sext i32 %111 to i64
  %121 = add nsw i64 %119, %120, !dbg !647
  %scevgep10.sum = add nsw i64 %121, -3
  %scevgep11 = getelementptr i32* %112, i64 %scevgep10.sum
  %scevgep1112 = bitcast i32* %scevgep11 to i8*
  call void @llvm.memcpy.p0i8.p0i8.i64(i8* %iyw9, i8* %scevgep1112, i64 28, i32 4, i1 false), !dbg !649
  %122 = sext i32 %113 to i64
  %123 = sext i32 %114 to i64
  %124 = add nsw i64 %122, %123, !dbg !647
  %scevgep14.sum = add nsw i64 %124, -3
  %scevgep15 = getelementptr i32* %115, i64 %scevgep14.sum
  %scevgep1516 = bitcast i32* %scevgep15 to i8*
  call void @llvm.memcpy.p0i8.p0i8.i64(i8* %izw13, i8* %scevgep1516, i64 28, i32 4, i1 false), !dbg !650
  %125 = getelementptr inbounds float* %charge, i64 %indvars.iv, !dbg !651
  %126 = load float* %125, align 4, !dbg !651, !tbaa !419
  call void @llvm.dbg.value(metadata float %126, i64 0, metadata !292, metadata !346), !dbg !652
  %127 = getelementptr inbounds [3 x float]* %f, i64 %indvars.iv, i64 0, !dbg !653
  call void @llvm.dbg.value(metadata float**** %ptr, i64 0, metadata !321, metadata !346), !dbg !516
  %128 = load float**** %ptr, align 8, !dbg !654, !tbaa !429
  %129 = call float @ps_gather_inner(i32* getelementptr inbounds ([81 x i32]* @ps_gather_f.JCXYZ, i64 0, i64 0), float* %94, i32* %97, i32* %98, i32* %99, float %36, float %38, float %40, float %42, float %44, float %46, float %126, float* %127, float*** %128) #8, !dbg !655
  call void @llvm.dbg.value(metadata float %129, i64 0, metadata !293, metadata !346), !dbg !656
  %130 = fmul float %126, %129, !dbg !657
  %131 = fadd float %energy.02, %130, !dbg !658
  call void @llvm.dbg.value(metadata float %131, i64 0, metadata !291, metadata !346), !dbg !659
  %132 = getelementptr inbounds float* %pot, i64 %indvars.iv, !dbg !660
  store float %129, float* %132, align 4, !dbg !661, !tbaa !419
  %indvars.iv.next = add nuw nsw i64 %indvars.iv, 1, !dbg !622
  %exitcond = icmp eq i32 %106, %100, !dbg !622
  br i1 %exitcond, label %._crit_edge, label %101, !dbg !622

._crit_edge:                                      ; preds = %101
  %phitmp = fmul float %131, 5.000000e-01, !dbg !622
  br label %133, !dbg !622

; <label>:133                                     ; preds = %._crit_edge, %.preheader
  %energy.0.lcssa = phi float [ %phitmp, %._crit_edge ], [ 0.000000e+00, %.preheader ]
  %134 = mul nsw i32 %natoms, 27, !dbg !662
  %135 = sitofp i32 %134 to double, !dbg !662
  %136 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 82, !dbg !662
  %137 = load double* %136, align 8, !dbg !662, !tbaa !663
  %138 = fadd double %135, %137, !dbg !662
  store double %138, double* %136, align 8, !dbg !662, !tbaa !663
  %139 = mul nsw i32 %natoms, 3, !dbg !665
  %140 = sitofp i32 %139 to double, !dbg !665
  %141 = getelementptr inbounds %struct.t_nrnb* %nrnb, i64 0, i32 0, i64 79, !dbg !665
  %142 = load double* %141, align 8, !dbg !665, !tbaa !663
  %143 = fadd double %140, %142, !dbg !665
  store double %143, double* %141, align 8, !dbg !665, !tbaa !663
  call void @llvm.lifetime.end(i64 108, i8* %1) #5, !dbg !666
  ret float %energy.0.lcssa, !dbg !666
}
