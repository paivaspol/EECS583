define i32 @read_xpm_matrix(i8* %fnm, %struct.t_matrix** nocapture %matrix) #0 {
entry:
  %line = alloca i8*, align 8
  %call = call %struct._IO_FILE* @ffopen(i8* %fnm, i8* getelementptr inbounds ([2 x i8]* @.str45, i64 0, i64 0)) #8
  br label %while.cond.outer

while.cond.outer:                                 ; preds = %if.then, %entry
  %indvars.iv = phi i64 [ %indvars.iv.next, %if.then ], [ 0, %entry ]
  %nmat.0.ph = phi i32 [ %add, %if.then ], [ 0, %entry ]
  br label %while.cond

while.cond:                                       ; preds = %while.cond.outer, %while.body
  %call1 = call i8* @fgetline(i8** %line, i32 4096, %struct._IO_FILE* %call) #9
  %tobool = icmp eq i8* %call1, null
  br i1 %tobool, label %while.end, label %while.body

while.body:                                       ; preds = %while.cond
  %0 = load i8** %line, align 8, !tbaa !0
  %call2 = call i8* @strstr(i8* %0, i8* getelementptr inbounds ([10 x i8]* @.str46, i64 0, i64 0)) #10
  %tobool3 = icmp eq i8* %call2, null
  br i1 %tobool3, label %while.cond, label %if.then

if.then:                                          ; preds = %while.body
  %1 = load %struct.t_matrix** %matrix, align 8, !tbaa !0
  %2 = bitcast %struct.t_matrix* %1 to i8*
  %indvars.iv.next = add i64 %indvars.iv, 1
  %add = add nsw i32 %nmat.0.ph, 1
  %3 = trunc i64 %indvars.iv.next to i32
  %mul = mul i32 %3, 1080
  %call5 = call i8* @save_realloc(i8* getelementptr inbounds ([8 x i8]* @.str47, i64 0, i64 0), i8* getelementptr inbounds ([53 x i8]* @.str1, i64 0, i64 0), i32 424, i8* %2, i32 %mul) #8
  %4 = bitcast i8* %call5 to %struct.t_matrix*
  store %struct.t_matrix* %4, %struct.t_matrix** %matrix, align 8, !tbaa !0
  %arrayidx = getelementptr inbounds %struct.t_matrix* %4, i64 %indvars.iv
  call void @read_xpm_entry(%struct._IO_FILE* %call, %struct.t_matrix* %arrayidx) #9
  br label %while.cond.outer

while.end:                                        ; preds = %while.cond
  call void @ffclose(%struct._IO_FILE* %call) #8
  %cmp = icmp eq i32 %nmat.0.ph, 0
  br i1 %cmp, label %if.then7, label %if.end8

if.then7:                                         ; preds = %while.end
  call void (i32, i8*, ...)* @fatal_error(i32 0, i8* getelementptr inbounds ([17 x i8]* @.str23, i64 0, i64 0)) #8
  br label %if.end8

if.end8:                                          ; preds = %if.then7, %while.end
  ret i32 %nmat.0.ph
}
