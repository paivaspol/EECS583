define void @do_shakefirst(%struct._IO_FILE* %log, i32 %bTYZ, float %lambda, float* %ener, %struct.t_parm* %parm, %struct.t_nsborder* nocapture %nsb, %struct.t_mdatoms* %md, [3 x float]* %x, [3 x float]* %vold, [3 x float]* %buf, [3 x float]* %f, [3 x float]* nocapture %v, %struct.t_graph* %graph, %struct.t_commrec* %cr, %struct.t_nrnb* %nrnb, %struct.t_groups* %grps, %struct.t_forcerec* nocapture %fr, %struct.t_topology* %top, %struct.t_edsamyn* %edyn, %struct.t_pull* %pulldata) #0 {
entry:
  %shake_vir = alloca [3 x [3 x float]], align 16
  %vcm = alloca [4 x double], align 16
  %vcm278 = bitcast [4 x double]* %vcm to i8*
  %0 = bitcast [3 x [3 x float]]* %shake_vir to i8*
  call void @llvm.lifetime.start(i64 36, i8* %0) #1
  %delta_t = getelementptr inbounds %struct.t_parm* %parm, i64 0, i32 0, i32 15
  %1 = load float* %delta_t, align 4, !tbaa !3
  %call = call i32 @count_constraints(%struct.t_topology* %top, %struct.t_commrec* %cr) #6
  %tobool = icmp eq i32 %call, 0
  br i1 %tobool, label %if.end155, label %if.then

if.then:                                          ; preds = %entry
  %nodeid = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 0
  %2 = load i32* %nodeid, align 4, !tbaa !0
  %idxprom = sext i32 %2 to i64
  %arrayidx = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 8, i64 %idxprom
  %3 = load i32* %arrayidx, align 4, !tbaa !0
  %arrayidx4 = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 7, i64 %idxprom
  %4 = load i32* %arrayidx4, align 4, !tbaa !0
  %add = add nsw i32 %4, %3
  %5 = load %struct._IO_FILE** @debug, align 8, !tbaa !5
  %tobool5 = icmp eq %struct._IO_FILE* %5, null
  br i1 %tobool5, label %if.end, label %if.then6

if.then6:                                         ; preds = %if.then
  %call7 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %5, i8* getelementptr inbounds ([34 x i8]* @.str10, i64 0, i64 0), i32 %3, i32 %4, i32 %add) #6
  br label %if.end

if.end:                                           ; preds = %if.then, %if.then6
  %tobool8 = icmp ne %struct._IO_FILE* %log, null
  br i1 %tobool8, label %if.then9, label %if.end11

if.then9:                                         ; preds = %if.end
  %call10 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %log, i8* getelementptr inbounds ([50 x i8]* @.str11, i64 0, i64 0), i32 -2) #6
  br label %if.end11

if.end11:                                         ; preds = %if.then9, %if.end
  %arraydecay = getelementptr inbounds [3 x [3 x float]]* %shake_vir, i64 0, i64 0
  call void @llvm.memset.p0i8.i64(i8* %0, i8 0, i64 36, i32 16, i1 false) #1
  %natoms = getelementptr inbounds %struct.t_nsborder* %nsb, i64 0, i32 3
  %6 = load i32* %natoms, align 4, !tbaa !0
  %arrayidx12 = getelementptr inbounds float* %ener, i64 42
  call void @update(i32 %6, i32 %3, i32 %4, i32 -2, float %lambda, float* %arrayidx12, %struct.t_parm* %parm, float 1.000000e+00, %struct.t_mdatoms* %md, [3 x float]* %x, %struct.t_graph* %graph, [3 x float]* null, [3 x float]* null, [3 x float]* %vold, [3 x float]* null, [3 x float]* %x, %struct.t_topology* %top, %struct.t_groups* %grps, [3 x float]* %arraydecay, %struct.t_commrec* %cr, %struct.t_nrnb* %nrnb, i32 %bTYZ, i32 0, %struct.t_edsamyn* %edyn, %struct.t_pull* %pulldata, i32 0) #6
  %cmp260 = icmp sgt i32 %4, 0
  br i1 %cmp260, label %for.cond14.preheader.lr.ph, label %for.end39

for.cond14.preheader.lr.ph:                       ; preds = %if.end11
  %7 = sext i32 %3 to i64
  br label %for.cond14.preheader

for.cond14.preheader:                             ; preds = %for.cond14.preheader.lr.ph, %for.inc37
  %indvars.iv284 = phi i64 [ %7, %for.cond14.preheader.lr.ph ], [ %indvars.iv.next285, %for.inc37 ]
  br label %for.body16

for.body16:                                       ; preds = %for.body16, %for.cond14.preheader
  %indvars.iv279 = phi i64 [ 0, %for.cond14.preheader ], [ %indvars.iv.next280, %for.body16 ]
  %arrayidx20 = getelementptr inbounds [3 x float]* %x, i64 %indvars.iv284, i64 %indvars.iv279
  %8 = load float* %arrayidx20, align 4, !tbaa !3
  %arrayidx24 = getelementptr inbounds [3 x float]* %f, i64 %indvars.iv284, i64 %indvars.iv279
  store float %8, float* %arrayidx24, align 4, !tbaa !3
  %9 = load float* %arrayidx20, align 4, !tbaa !3
  %arrayidx32 = getelementptr inbounds [3 x float]* %v, i64 %indvars.iv284, i64 %indvars.iv279
  %10 = load float* %arrayidx32, align 4, !tbaa !3
  %mul = fmul float %1, %10
  %sub = fsub float %9, %mul
  %arrayidx36 = getelementptr inbounds [3 x float]* %buf, i64 %indvars.iv284, i64 %indvars.iv279
  store float %sub, float* %arrayidx36, align 4, !tbaa !3
  %indvars.iv.next280 = add i64 %indvars.iv279, 1
  %lftr.wideiv281 = trunc i64 %indvars.iv.next280 to i32
  %exitcond282 = icmp eq i32 %lftr.wideiv281, 3
  br i1 %exitcond282, label %for.inc37, label %for.body16

for.inc37:                                        ; preds = %for.body16
  %indvars.iv.next285 = add i64 %indvars.iv284, 1
  %11 = trunc i64 %indvars.iv.next285 to i32
  %cmp = icmp slt i32 %11, %add
  br i1 %cmp, label %for.cond14.preheader, label %for.end39

for.end39:                                        ; preds = %for.inc37, %if.end11
  br i1 %tobool8, label %if.then41, label %if.end43

if.then41:                                        ; preds = %for.end39
  %call42 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %log, i8* getelementptr inbounds ([50 x i8]* @.str12, i64 0, i64 0), i32 -1) #6
  br label %if.end43

if.end43:                                         ; preds = %if.then41, %for.end39
  call void @llvm.memset.p0i8.i64(i8* %0, i8 0, i64 36, i32 16, i1 false) #1
  %12 = load i32* %natoms, align 4, !tbaa !0
  call void @update(i32 %12, i32 %3, i32 %4, i32 -1, float %lambda, float* %arrayidx12, %struct.t_parm* %parm, float 1.000000e+00, %struct.t_mdatoms* %md, [3 x float]* %f, %struct.t_graph* %graph, [3 x float]* null, [3 x float]* null, [3 x float]* %vold, [3 x float]* null, [3 x float]* %buf, %struct.t_topology* %top, %struct.t_groups* %grps, [3 x float]* %arraydecay, %struct.t_commrec* %cr, %struct.t_nrnb* %nrnb, i32 %bTYZ, i32 0, %struct.t_edsamyn* %edyn, %struct.t_pull* %pulldata, i32 0) #6
  call void @llvm.memset.p0i8.i64(i8* %vcm278, i8 0, i64 32, i32 16, i1 false)
  %conv56 = fdiv float 1.000000e+00, %1
  br i1 %cmp260, label %for.body60.lr.ph, label %for.end98

for.body60.lr.ph:                                 ; preds = %if.end43
  %massA = getelementptr inbounds %struct.t_mdatoms* %md, i64 0, i32 2
  %13 = load float** %massA, align 8, !tbaa !5
  %arrayidx94 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 3
  %14 = sext i32 %3 to i64
  br label %for.body60

for.body60:                                       ; preds = %for.body60.lr.ph, %for.end93
  %indvars.iv272 = phi i64 [ %14, %for.body60.lr.ph ], [ %indvars.iv.next273, %for.end93 ]
  %arrayidx62 = getelementptr inbounds float* %13, i64 %indvars.iv272
  %15 = load float* %arrayidx62, align 4, !tbaa !3
  %conv63 = fpext float %15 to double
  br label %for.body67

for.body67:                                       ; preds = %for.body67, %for.body60
  %indvars.iv268 = phi i64 [ 0, %for.body60 ], [ %indvars.iv.next269, %for.body67 ]
  %arrayidx71 = getelementptr inbounds [3 x float]* %x, i64 %indvars.iv272, i64 %indvars.iv268
  %16 = load float* %arrayidx71, align 4, !tbaa !3
  %arrayidx75 = getelementptr inbounds [3 x float]* %f, i64 %indvars.iv272, i64 %indvars.iv268
  %17 = load float* %arrayidx75, align 4, !tbaa !3
  %sub76 = fsub float %16, %17
  %mul77 = fmul float %conv56, %sub76
  %arrayidx81 = getelementptr inbounds [3 x float]* %v, i64 %indvars.iv272, i64 %indvars.iv268
  store float %mul77, float* %arrayidx81, align 4, !tbaa !3
  %conv86 = fpext float %mul77 to double
  %mul87 = fmul double %conv63, %conv86
  %arrayidx89 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 %indvars.iv268
  %18 = load double* %arrayidx89, align 8, !tbaa !6
  %add90 = fadd double %18, %mul87
  store double %add90, double* %arrayidx89, align 8, !tbaa !6
  %indvars.iv.next269 = add i64 %indvars.iv268, 1
  %lftr.wideiv270 = trunc i64 %indvars.iv.next269 to i32
  %exitcond271 = icmp eq i32 %lftr.wideiv270, 3
  br i1 %exitcond271, label %for.end93, label %for.body67

for.end93:                                        ; preds = %for.body67
  %19 = load double* %arrayidx94, align 8, !tbaa !6
  %add95 = fadd double %conv63, %19
  store double %add95, double* %arrayidx94, align 8, !tbaa !6
  %indvars.iv.next273 = add i64 %indvars.iv272, 1
  %20 = trunc i64 %indvars.iv.next273 to i32
  %cmp58 = icmp slt i32 %20, %add
  br i1 %cmp58, label %for.body60, label %for.end98

for.end98:                                        ; preds = %for.end93, %if.end43
  %21 = phi double [ 0.000000e+00, %if.end43 ], [ %add95, %for.end93 ]
  %22 = load %struct._IO_FILE** @debug, align 8, !tbaa !5
  %tobool99 = icmp eq %struct._IO_FILE* %22, null
  br i1 %tobool99, label %if.end106, label %if.then100

if.then100:                                       ; preds = %for.end98
  %arrayidx101 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 0
  %23 = load double* %arrayidx101, align 16, !tbaa !6
  %arrayidx102 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 1
  %24 = load double* %arrayidx102, align 8, !tbaa !6
  %arrayidx103 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 2
  %25 = load double* %arrayidx103, align 16, !tbaa !6
  %call105 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %22, i8* getelementptr inbounds ([47 x i8]* @.str13, i64 0, i64 0), double %23, double %24, double %25, double %21) #6
  br label %if.end106

if.end106:                                        ; preds = %for.end98, %if.then100
  %nnodes = getelementptr inbounds %struct.t_commrec* %cr, i64 0, i32 1
  %26 = load i32* %nnodes, align 4, !tbaa !0
  %cmp107 = icmp sgt i32 %26, 1
  br i1 %cmp107, label %if.then111, label %lor.lhs.false

lor.lhs.false:                                    ; preds = %if.end106
  %nthreads = getelementptr inbounds %struct.t_commrec* %cr, i64 0, i32 5
  %27 = load i32* %nthreads, align 4, !tbaa !0
  %cmp109 = icmp sgt i32 %27, 1
  br i1 %cmp109, label %if.then111, label %if.end113

if.then111:                                       ; preds = %lor.lhs.false, %if.end106
  %arraydecay112 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 0
  call void @gmx_sumd(i32 4, double* %arraydecay112, %struct.t_commrec* %cr) #6
  br label %if.end113

if.end113:                                        ; preds = %lor.lhs.false, %if.then111
  %arrayidx114 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 3
  %28 = load double* %arrayidx114, align 8, !tbaa !6
  br label %for.body118

for.body118:                                      ; preds = %for.body118, %if.end113
  %indvars.iv264 = phi i64 [ 0, %if.end113 ], [ %indvars.iv.next265, %for.body118 ]
  %arrayidx120 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 %indvars.iv264
  %29 = load double* %arrayidx120, align 8, !tbaa !6
  %div121 = fdiv double %29, %28
  store double %div121, double* %arrayidx120, align 8, !tbaa !6
  %indvars.iv.next265 = add i64 %indvars.iv264, 1
  %lftr.wideiv266 = trunc i64 %indvars.iv.next265 to i32
  %exitcond267 = icmp eq i32 %lftr.wideiv266, 3
  br i1 %exitcond267, label %for.end124, label %for.body118

for.end124:                                       ; preds = %for.body118
  %30 = load %struct._IO_FILE** @debug, align 8, !tbaa !5
  %tobool125 = icmp eq %struct._IO_FILE* %30, null
  br i1 %tobool125, label %for.cond132.preheader, label %if.then126

if.then126:                                       ; preds = %for.end124
  %arrayidx127 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 0
  %31 = load double* %arrayidx127, align 16, !tbaa !6
  %arrayidx128 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 1
  %32 = load double* %arrayidx128, align 8, !tbaa !6
  %arrayidx129 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 2
  %33 = load double* %arrayidx129, align 16, !tbaa !6
  %call130 = call i32 (%struct._IO_FILE*, i8*, ...)* @fprintf(%struct._IO_FILE* %30, i8* getelementptr inbounds ([47 x i8]* @.str13, i64 0, i64 0), double %31, double %32, double %33, double %28) #6
  br label %for.cond132.preheader

for.cond132.preheader:                            ; preds = %for.end124, %if.then126
  br i1 %cmp260, label %for.cond136.preheader.lr.ph, label %if.end155

for.cond136.preheader.lr.ph:                      ; preds = %for.cond132.preheader
  %34 = sext i32 %3 to i64
  br label %for.cond136.preheader

for.cond136.preheader:                            ; preds = %for.cond136.preheader.lr.ph, %for.inc152
  %indvars.iv262 = phi i64 [ %34, %for.cond136.preheader.lr.ph ], [ %indvars.iv.next263, %for.inc152 ]
  br label %for.body139

for.body139:                                      ; preds = %for.body139, %for.cond136.preheader
  %indvars.iv = phi i64 [ 0, %for.cond136.preheader ], [ %indvars.iv.next, %for.body139 ]
  %arrayidx141 = getelementptr inbounds [4 x double]* %vcm, i64 0, i64 %indvars.iv
  %35 = load double* %arrayidx141, align 8, !tbaa !6
  %arrayidx145 = getelementptr inbounds [3 x float]* %v, i64 %indvars.iv262, i64 %indvars.iv
  %36 = load float* %arrayidx145, align 4, !tbaa !3
  %conv146 = fpext float %36 to double
  %sub147 = fsub double %conv146, %35
  %conv148 = fptrunc double %sub147 to float
  store float %conv148, float* %arrayidx145, align 4, !tbaa !3
  %indvars.iv.next = add i64 %indvars.iv, 1
  %lftr.wideiv = trunc i64 %indvars.iv.next to i32
  %exitcond = icmp eq i32 %lftr.wideiv, 3
  br i1 %exitcond, label %for.inc152, label %for.body139

for.inc152:                                       ; preds = %for.body139
  %indvars.iv.next263 = add i64 %indvars.iv262, 1
  %37 = trunc i64 %indvars.iv.next263 to i32
  %cmp133 = icmp slt i32 %37, %add
  br i1 %cmp133, label %for.cond136.preheader, label %if.end155

if.end155:                                        ; preds = %for.cond132.preheader, %for.inc152, %entry
  call void @llvm.lifetime.end(i64 36, i8* %0) #1
  ret void
}
