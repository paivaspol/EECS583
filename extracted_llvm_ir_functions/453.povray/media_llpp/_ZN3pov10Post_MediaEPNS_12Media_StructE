define void @_ZN3pov10Post_MediaEPNS_12Media_StructE(%"struct.pov::Media_Struct"* %IMedia) #0 {
entry:
  tail call void @llvm.dbg.value(metadata !{%"struct.pov::Media_Struct"* %IMedia}, i64 0, metadata !1083), !dbg !2452
  %cmp133 = icmp eq %"struct.pov::Media_Struct"* %IMedia, null, !dbg !2453
  br i1 %cmp133, label %return, label %if.end, !dbg !2453

if.end:                                           ; preds = %entry, %if.end89
  %IMedia.tr134 = phi %"struct.pov::Media_Struct"* [ %31, %if.end89 ], [ %IMedia, %entry ]
  %arraydecay = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 15, i64 0, !dbg !2454
  %arraydecay1 = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 13, i64 0, !dbg !2454
  %sc_ext = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 8, !dbg !2454
  %0 = load double* %sc_ext, align 8, !dbg !2454, !tbaa !1601
  %conv = fptrunc double %0 to float, !dbg !2454
  %arraydecay2 = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 16, i64 0, !dbg !2454
  tail call void @llvm.dbg.value(metadata !{float* %arraydecay}, i64 0, metadata !2455), !dbg !2456
  tail call void @llvm.dbg.value(metadata !1876, i64 0, metadata !2457), !dbg !2456
  tail call void @llvm.dbg.value(metadata !{float* %arraydecay1}, i64 0, metadata !2458), !dbg !2456
  tail call void @llvm.dbg.value(metadata !{float %conv}, i64 0, metadata !2459), !dbg !2456
  tail call void @llvm.dbg.value(metadata !{float* %arraydecay2}, i64 0, metadata !2460), !dbg !2456
  %1 = load float* %arraydecay1, align 4, !dbg !2461, !tbaa !1621
  %2 = load float* %arraydecay2, align 4, !dbg !2461, !tbaa !1621
  %mul2.i = fmul float %conv, %2, !dbg !2461
  %add.i = fadd float %1, %mul2.i, !dbg !2461
  store float %add.i, float* %arraydecay, align 4, !dbg !2461, !tbaa !1621
  %arrayidx4.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 13, i64 1, !dbg !2463
  %3 = load float* %arrayidx4.i, align 4, !dbg !2463, !tbaa !1621
  %arrayidx6.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 16, i64 1, !dbg !2463
  %4 = load float* %arrayidx6.i, align 4, !dbg !2463, !tbaa !1621
  %mul7.i = fmul float %conv, %4, !dbg !2463
  %add8.i = fadd float %3, %mul7.i, !dbg !2463
  %arrayidx9.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 15, i64 1, !dbg !2463
  store float %add8.i, float* %arrayidx9.i, align 4, !dbg !2463, !tbaa !1621
  %arrayidx10.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 13, i64 2, !dbg !2464
  %5 = load float* %arrayidx10.i, align 4, !dbg !2464, !tbaa !1621
  %arrayidx12.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 16, i64 2, !dbg !2464
  %6 = load float* %arrayidx12.i, align 4, !dbg !2464, !tbaa !1621
  %mul13.i = fmul float %conv, %6, !dbg !2464
  %add14.i = fadd float %5, %mul13.i, !dbg !2464
  %arrayidx15.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 15, i64 2, !dbg !2464
  store float %add14.i, float* %arrayidx15.i, align 4, !dbg !2464, !tbaa !1621
  %arrayidx16.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 13, i64 3, !dbg !2465
  %7 = load float* %arrayidx16.i, align 4, !dbg !2465, !tbaa !1621
  %arrayidx18.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 16, i64 3, !dbg !2465
  %8 = load float* %arrayidx18.i, align 4, !dbg !2465, !tbaa !1621
  %mul19.i = fmul float %conv, %8, !dbg !2465
  %add20.i = fadd float %7, %mul19.i, !dbg !2465
  %arrayidx21.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 15, i64 3, !dbg !2465
  store float %add20.i, float* %arrayidx21.i, align 4, !dbg !2465, !tbaa !1621
  %arrayidx22.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 13, i64 4, !dbg !2466
  %9 = load float* %arrayidx22.i, align 4, !dbg !2466, !tbaa !1621
  %arrayidx24.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 16, i64 4, !dbg !2466
  %10 = load float* %arrayidx24.i, align 4, !dbg !2466, !tbaa !1621
  %mul25.i = fmul float %conv, %10, !dbg !2466
  %add26.i = fadd float %9, %mul25.i, !dbg !2466
  %arrayidx27.i = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 15, i64 4, !dbg !2466
  store float %add26.i, float* %arrayidx27.i, align 4, !dbg !2466, !tbaa !1621
  %cmp5 = fcmp une float %1, 0.000000e+00, !dbg !2467
  %cmp9 = fcmp une float %3, 0.000000e+00, !dbg !2467
  %or.cond = or i1 %cmp5, %cmp9, !dbg !2467
  br i1 %or.cond, label %lor.end, label %lor.rhs, !dbg !2467

lor.rhs:                                          ; preds = %if.end
  %cmp13 = fcmp une float %5, 0.000000e+00, !dbg !2467
  br label %lor.end, !dbg !2467

lor.end:                                          ; preds = %lor.rhs, %if.end
  %11 = phi i1 [ true, %if.end ], [ %cmp13, %lor.rhs ]
  %conv14 = zext i1 %11 to i32, !dbg !2467
  %use_absorption = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 9, !dbg !2467
  store i32 %conv14, i32* %use_absorption, align 4, !dbg !2467, !tbaa !1580
  %arrayidx15 = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 14, i64 0, !dbg !2468
  %12 = load float* %arrayidx15, align 4, !dbg !2468, !tbaa !1621
  %cmp17 = fcmp une float %12, 0.000000e+00, !dbg !2468
  br i1 %cmp17, label %lor.end28, label %lor.lhs.false18, !dbg !2468

lor.lhs.false18:                                  ; preds = %lor.end
  %arrayidx20 = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 14, i64 1, !dbg !2468
  %13 = load float* %arrayidx20, align 4, !dbg !2468, !tbaa !1621
  %cmp22 = fcmp une float %13, 0.000000e+00, !dbg !2468
  br i1 %cmp22, label %lor.end28, label %lor.rhs23, !dbg !2468

lor.rhs23:                                        ; preds = %lor.lhs.false18
  %arrayidx25 = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 14, i64 2, !dbg !2468
  %14 = load float* %arrayidx25, align 4, !dbg !2468, !tbaa !1621
  %cmp27 = fcmp une float %14, 0.000000e+00, !dbg !2468
  br label %lor.end28, !dbg !2468

lor.end28:                                        ; preds = %lor.rhs23, %lor.lhs.false18, %lor.end
  %15 = phi i1 [ true, %lor.lhs.false18 ], [ true, %lor.end ], [ %cmp27, %lor.rhs23 ]
  %conv29 = zext i1 %15 to i32, !dbg !2468
  %use_emission = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 10, !dbg !2468
  store i32 %conv29, i32* %use_emission, align 4, !dbg !2468, !tbaa !1580
  %cmp33 = fcmp une float %2, 0.000000e+00, !dbg !2469
  %cmp38 = fcmp une float %4, 0.000000e+00, !dbg !2469
  %or.cond135 = or i1 %cmp33, %cmp38, !dbg !2469
  br i1 %or.cond135, label %lor.end44, label %lor.rhs39, !dbg !2469

lor.rhs39:                                        ; preds = %lor.end28
  %cmp43 = fcmp une float %6, 0.000000e+00, !dbg !2469
  br label %lor.end44, !dbg !2469

lor.end44:                                        ; preds = %lor.rhs39, %lor.end28
  %16 = phi i1 [ true, %lor.end28 ], [ %cmp43, %lor.rhs39 ]
  %conv45 = zext i1 %16 to i32, !dbg !2469
  %use_scattering = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 12, !dbg !2469
  store i32 %conv45, i32* %use_scattering, align 4, !dbg !2469, !tbaa !1580
  %. = or i1 %16, %11, !dbg !2470
  %conv51 = zext i1 %. to i32, !dbg !2470
  %use_extinction = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 11, !dbg !2470
  store i32 %conv51, i32* %use_extinction, align 4, !dbg !2470, !tbaa !1580
  %Density = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 24, !dbg !2471
  %17 = load %"struct.pov::Pigment_Struct"** %Density, align 8, !dbg !2471, !tbaa !1570
  %cmp52 = icmp eq %"struct.pov::Pigment_Struct"* %17, null, !dbg !2471
  %conv53 = zext i1 %cmp52 to i32, !dbg !2471
  %is_constant = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 6, !dbg !2471
  store i32 %conv53, i32* %is_constant, align 4, !dbg !2471, !tbaa !1580
  %Sample_Threshold = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 20, !dbg !2472
  %18 = load double** %Sample_Threshold, align 8, !dbg !2472, !tbaa !1570
  %cmp54 = icmp eq double* %18, null, !dbg !2472
  br i1 %cmp54, label %if.end58, label %if.then55, !dbg !2472

if.then55:                                        ; preds = %lor.end44
  %19 = bitcast double* %18 to i8*, !dbg !2473
  tail call void @_ZN3pov8pov_freeEPvPKci(i8* %19, i8* getelementptr inbounds ([54 x i8]* @.str, i64 0, i64 0), i32 2129) #7, !dbg !2473
  store double* null, double** %Sample_Threshold, align 8, !dbg !2473, !tbaa !1570
  br label %if.end58, !dbg !2476

if.end58:                                         ; preds = %lor.end44, %if.then55
  %Max_Samples = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 3, !dbg !2477
  %20 = load i32* %Max_Samples, align 4, !dbg !2477, !tbaa !1580
  %conv59 = sext i32 %20 to i64, !dbg !2477
  %mul = shl nsw i64 %conv59, 3, !dbg !2477
  %call = tail call i8* @_ZN3pov10pov_mallocEmPKciS1_(i64 %mul, i8* getelementptr inbounds ([54 x i8]* @.str, i64 0, i64 0), i32 2134, i8* getelementptr inbounds ([22 x i8]* @.str2, i64 0, i64 0)) #7, !dbg !2477
  %21 = bitcast i8* %call to double*, !dbg !2477
  store double* %21, double** %Sample_Threshold, align 8, !dbg !2477, !tbaa !1570
  %22 = load i32* %Max_Samples, align 4, !dbg !2478, !tbaa !1580
  %cmp62 = icmp sgt i32 %22, 1, !dbg !2478
  br i1 %cmp62, label %if.then63, label %if.else80, !dbg !2478

if.then63:                                        ; preds = %if.end58
  %sub = add nsw i32 %22, -1, !dbg !2479
  %conv65 = sitofp i32 %sub to double, !dbg !2479
  %Confidence = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 18, !dbg !2479
  %23 = load double* %Confidence, align 8, !dbg !2479, !tbaa !1601
  %call66 = tail call double @_ZN3pov6chdtriEdd(double %conv65, double %23) #7, !dbg !2479
  tail call void @llvm.dbg.value(metadata !{double %call66}, i64 0, metadata !1085), !dbg !2479
  %cmp67 = fcmp ogt double %call66, 0.000000e+00, !dbg !2481
  %Variance = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 19, !dbg !2482
  %24 = load double* %Variance, align 8, !dbg !2482, !tbaa !1601
  br i1 %cmp67, label %if.then68, label %if.else, !dbg !2481

if.then68:                                        ; preds = %if.then63
  %div = fdiv double %24, %call66, !dbg !2482
  tail call void @llvm.dbg.value(metadata !{double %div}, i64 0, metadata !1085), !dbg !2482
  br label %if.end71, !dbg !2484

if.else:                                          ; preds = %if.then63
  %mul70 = fmul double %24, 1.000000e-07, !dbg !2485
  tail call void @llvm.dbg.value(metadata !{double %mul70}, i64 0, metadata !1085), !dbg !2485
  br label %if.end71

if.end71:                                         ; preds = %if.else, %if.then68
  %t.0 = phi double [ %div, %if.then68 ], [ %mul70, %if.else ]
  tail call void @llvm.dbg.value(metadata !204, i64 0, metadata !1084), !dbg !2487
  %25 = load i32* %Max_Samples, align 4, !dbg !2487, !tbaa !1580
  %cmp73131 = icmp sgt i32 %25, 0, !dbg !2487
  br i1 %cmp73131, label %for.body, label %if.end83, !dbg !2487

for.body:                                         ; preds = %if.end71, %for.body
  %indvars.iv = phi i64 [ %indvars.iv.next, %for.body ], [ 0, %if.end71 ]
  %indvars.iv.next = add i64 %indvars.iv, 1, !dbg !2487
  %26 = trunc i64 %indvars.iv.next to i32, !dbg !2489
  %conv74 = sitofp i32 %26 to double, !dbg !2489
  %27 = load double* %Confidence, align 8, !dbg !2489, !tbaa !1601
  %call76 = tail call double @_ZN3pov6chdtriEdd(double %conv74, double %27) #7, !dbg !2489
  %mul77 = fmul double %t.0, %call76, !dbg !2489
  %28 = load double** %Sample_Threshold, align 8, !dbg !2489, !tbaa !1570
  %arrayidx79 = getelementptr inbounds double* %28, i64 %indvars.iv, !dbg !2489
  store double %mul77, double* %arrayidx79, align 8, !dbg !2489, !tbaa !1601
  %29 = load i32* %Max_Samples, align 4, !dbg !2487, !tbaa !1580
  %cmp73 = icmp slt i32 %26, %29, !dbg !2487
  br i1 %cmp73, label %for.body, label %if.end83, !dbg !2487

if.else80:                                        ; preds = %if.end58
  store double 0.000000e+00, double* %21, align 8, !dbg !2491, !tbaa !1601
  br label %if.end83

if.end83:                                         ; preds = %if.end71, %for.body, %if.else80
  %30 = load %"struct.pov::Pigment_Struct"** %Density, align 8, !dbg !2493, !tbaa !1570
  %cmp85 = icmp eq %"struct.pov::Pigment_Struct"* %30, null, !dbg !2493
  br i1 %cmp85, label %if.end89, label %if.then86, !dbg !2493

if.then86:                                        ; preds = %if.end83
  %call88 = tail call i32 @_ZN3pov12Post_PigmentEPNS_14Pigment_StructE(%"struct.pov::Pigment_Struct"* %30) #7, !dbg !2494
  br label %if.end89, !dbg !2496

if.end89:                                         ; preds = %if.end83, %if.then86
  %Next_Media = getelementptr inbounds %"struct.pov::Media_Struct"* %IMedia.tr134, i64 0, i32 25, !dbg !2497
  %31 = load %"struct.pov::Media_Struct"** %Next_Media, align 8, !dbg !2497, !tbaa !1570
  tail call void @llvm.dbg.value(metadata !{%"struct.pov::Media_Struct"* %IMedia.tr134}, i64 0, metadata !1083), !dbg !2452
  %cmp = icmp eq %"struct.pov::Media_Struct"* %31, null, !dbg !2453
  br i1 %cmp, label %return, label %if.end, !dbg !2453

return:                                           ; preds = %if.end89, %entry
  ret void, !dbg !2497
}
