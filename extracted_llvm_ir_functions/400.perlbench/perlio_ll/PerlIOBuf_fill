define i64 @PerlIOBuf_fill(%struct._PerlIO** %f) #1 {
entry:
  %0 = load %struct._PerlIO** %f, align 8, !tbaa !3
  %next = getelementptr inbounds %struct._PerlIO* %0, i64 0, i32 0
  %call = tail call i32 @Perl_PerlIO_flush(%struct._PerlIO** %f) #10
  %cmp = icmp eq i32 %call, 0
  br i1 %cmp, label %if.end, label %return

if.end:                                           ; preds = %entry
  %1 = load %struct._PerlIO** %f, align 8, !tbaa !3
  %flags = getelementptr inbounds %struct._PerlIO* %1, i64 0, i32 2
  %2 = load i32* %flags, align 4, !tbaa !0
  %and = and i32 %2, 8388608
  %tobool = icmp eq i32 %and, 0
  br i1 %tobool, label %if.end2, label %if.then1

if.then1:                                         ; preds = %if.end
  tail call void @PerlIOBase_flush_linebuf() #10
  br label %if.end2

if.end2:                                          ; preds = %if.end, %if.then1
  %buf = getelementptr inbounds %struct._PerlIO* %0, i64 1
  %3 = bitcast %struct._PerlIO* %buf to i8**
  %4 = load i8** %3, align 8, !tbaa !3
  %tobool3 = icmp eq i8* %4, null
  br i1 %tobool3, label %if.end6.thread, label %if.end6

if.end6.thread:                                   ; preds = %if.end2
  %call5 = tail call i8* @Perl_PerlIO_get_base(%struct._PerlIO** %f) #10
  %.pre = load i8** %3, align 8, !tbaa !3
  %end110 = getelementptr inbounds %struct._PerlIO* %0, i64 1, i32 1
  %.c111 = bitcast i8* %.pre to %struct._PerlIO_funcs*
  store %struct._PerlIO_funcs* %.c111, %struct._PerlIO_funcs** %end110, align 8, !tbaa !3
  %ptr112 = getelementptr inbounds %struct._PerlIO* %0, i64 1, i32 2
  %5 = bitcast i32* %ptr112 to i8**
  store i8* %.pre, i8** %5, align 8, !tbaa !3
  br label %land.lhs.true

if.end6:                                          ; preds = %if.end2
  %end = getelementptr inbounds %struct._PerlIO* %0, i64 1, i32 1
  %.c = bitcast i8* %4 to %struct._PerlIO_funcs*
  store %struct._PerlIO_funcs* %.c, %struct._PerlIO_funcs** %end, align 8, !tbaa !3
  %ptr = getelementptr inbounds %struct._PerlIO* %0, i64 1, i32 2
  %6 = bitcast i32* %ptr to i8**
  store i8* %4, i8** %6, align 8, !tbaa !3
  %tobool8 = icmp eq %struct._PerlIO* %0, null
  br i1 %tobool8, label %if.then10, label %land.lhs.true

land.lhs.true:                                    ; preds = %if.end6.thread, %if.end6
  %7 = phi i8** [ %5, %if.end6.thread ], [ %6, %if.end6 ]
  %end114 = phi %struct._PerlIO_funcs** [ %end110, %if.end6.thread ], [ %end, %if.end6 ]
  %8 = load %struct._PerlIO** %next, align 8, !tbaa !3
  %tobool9 = icmp eq %struct._PerlIO* %8, null
  br i1 %tobool9, label %if.then10, label %if.end12

if.then10:                                        ; preds = %land.lhs.true, %if.end6
  %9 = load %struct._PerlIO** %f, align 8, !tbaa !3
  %flags11 = getelementptr inbounds %struct._PerlIO* %9, i64 0, i32 2
  %10 = load i32* %flags11, align 4, !tbaa !0
  %or = or i32 %10, 256
  store i32 %or, i32* %flags11, align 4, !tbaa !0
  br label %return

if.end12:                                         ; preds = %land.lhs.true
  %call13 = tail call i32 @PerlIO_fast_gets(%struct._PerlIO** %next) #10
  %tobool14 = icmp eq i32 %call13, 0
  br i1 %tobool14, label %if.else49, label %if.then15

if.then15:                                        ; preds = %if.end12
  %call16 = tail call i32 @Perl_PerlIO_get_cnt(%struct._PerlIO** %next) #10
  %conv = sext i32 %call16 to i64
  %cmp17 = icmp slt i32 %call16, 1
  br i1 %cmp17, label %if.then19, label %if.end35

if.then19:                                        ; preds = %if.then15
  %call20 = tail call i32 @Perl_PerlIO_fill(%struct._PerlIO** %next) #10
  %conv21 = sext i32 %call20 to i64
  %cmp22 = icmp eq i32 %call20, 0
  br i1 %cmp22, label %if.then24, label %if.else

if.then24:                                        ; preds = %if.then19
  %call25 = tail call i32 @Perl_PerlIO_get_cnt(%struct._PerlIO** %next) #10
  %conv26 = sext i32 %call25 to i64
  br label %if.end35

if.else:                                          ; preds = %if.then19
  %call27 = tail call i32 @Perl_PerlIO_error(%struct._PerlIO** %next) #10
  %tobool28 = icmp eq i32 %call27, 0
  br i1 %tobool28, label %land.lhs.true29, label %if.end35

land.lhs.true29:                                  ; preds = %if.else
  %call30 = tail call i32 @Perl_PerlIO_eof(%struct._PerlIO** %next) #10
  %tobool31 = icmp eq i32 %call30, 0
  %conv21. = select i1 %tobool31, i64 %conv21, i64 0
  br label %if.end35

if.end35:                                         ; preds = %land.lhs.true29, %if.else, %if.then24, %if.then15
  %avail.0 = phi i64 [ %conv26, %if.then24 ], [ %conv21, %if.else ], [ %conv, %if.then15 ], [ %conv21., %land.lhs.true29 ]
  %cmp36 = icmp sgt i64 %avail.0, 0
  br i1 %cmp36, label %if.then38, label %if.then56

if.then38:                                        ; preds = %if.end35
  %call40 = tail call i8* @Perl_PerlIO_get_ptr(%struct._PerlIO** %next) #10
  %bufsiz = getelementptr inbounds %struct._PerlIO* %0, i64 2, i32 1
  %11 = bitcast %struct._PerlIO_funcs** %bufsiz to i64*
  %12 = load i64* %11, align 8, !tbaa !4
  %cmp41 = icmp sgt i64 %avail.0, %12
  %.avail.0 = select i1 %cmp41, i64 %12, i64 %avail.0
  %13 = load i8** %3, align 8, !tbaa !3
  tail call void @llvm.memcpy.p0i8.p0i8.i64(i8* %13, i8* %call40, i64 %.avail.0, i32 1, i1 false)
  %add.ptr = getelementptr inbounds i8* %call40, i64 %.avail.0
  %sub = sub nsw i64 %avail.0, %.avail.0
  %conv47 = trunc i64 %sub to i32
  tail call void @Perl_PerlIO_set_ptrcnt(%struct._PerlIO** %next, i8* %add.ptr, i32 %conv47) #10
  br label %if.end53

if.else49:                                        ; preds = %if.end12
  %14 = load i8** %7, align 8, !tbaa !3
  %bufsiz51 = getelementptr inbounds %struct._PerlIO* %0, i64 2, i32 1
  %15 = bitcast %struct._PerlIO_funcs** %bufsiz51 to i64*
  %16 = load i64* %15, align 8, !tbaa !4
  %call52 = tail call i64 @Perl_PerlIO_read(%struct._PerlIO** %next, i8* %14, i64 %16) #10
  br label %if.end53

if.end53:                                         ; preds = %if.then38, %if.else49
  %avail.2 = phi i64 [ %.avail.0, %if.then38 ], [ %call52, %if.else49 ]
  %cmp54 = icmp slt i64 %avail.2, 1
  br i1 %cmp54, label %if.then56, label %if.end66

if.then56:                                        ; preds = %if.end35, %if.end53
  %avail.2109 = phi i64 [ %avail.2, %if.end53 ], [ %avail.0, %if.end35 ]
  %cmp57 = icmp eq i64 %avail.2109, 0
  %17 = load %struct._PerlIO** %f, align 8, !tbaa !3
  %flags60 = getelementptr inbounds %struct._PerlIO* %17, i64 0, i32 2
  %18 = load i32* %flags60, align 4, !tbaa !0
  %storemerge.v = select i1 %cmp57, i32 256, i32 2048
  %storemerge = or i32 %18, %storemerge.v
  store i32 %storemerge, i32* %flags60, align 4, !tbaa !0
  br label %return

if.end66:                                         ; preds = %if.end53
  %19 = load i8** %3, align 8, !tbaa !3
  %add.ptr68 = getelementptr inbounds i8* %19, i64 %avail.2
  %add.ptr68.c = bitcast i8* %add.ptr68 to %struct._PerlIO_funcs*
  store %struct._PerlIO_funcs* %add.ptr68.c, %struct._PerlIO_funcs** %end114, align 8, !tbaa !3
  %20 = load %struct._PerlIO** %f, align 8, !tbaa !3
  %flags70 = getelementptr inbounds %struct._PerlIO* %20, i64 0, i32 2
  %21 = load i32* %flags70, align 4, !tbaa !0
  %or71 = or i32 %21, 262144
  store i32 %or71, i32* %flags70, align 4, !tbaa !0
  br label %return

return:                                           ; preds = %entry, %if.end66, %if.then56, %if.then10
  %retval.0 = phi i64 [ -1, %if.then56 ], [ 0, %if.end66 ], [ -1, %if.then10 ], [ -1, %entry ]
  ret i64 %retval.0
}
