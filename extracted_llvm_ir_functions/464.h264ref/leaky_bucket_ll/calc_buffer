define void @calc_buffer() #0 {
if.end:
  tail call void @llvm.dbg.value(metadata !643, i64 0, metadata !116), !dbg !667
  %0 = load %struct._IO_FILE** @stdout, align 8, !dbg !668, !tbaa !611
  %1 = tail call i64 @fwrite(i8* getelementptr inbounds ([81 x i8]* @.str8, i64 0, i64 0), i64 80, i64 1, %struct._IO_FILE* %0), !dbg !668
  %2 = load i64* @total_frame_buffer, align 8, !dbg !669, !tbaa !626
  %3 = load %struct.InputParameters** @input, align 8, !dbg !669, !tbaa !611
  %no_frames = getelementptr inbounds %struct.InputParameters* %3, i64 0, i32 2, !dbg !669
  %4 = load i32* %no_frames, align 4, !dbg !669, !tbaa !670
  %call1 = tail call i32 (i8*, ...)* @printf(i8* getelementptr inbounds ([27 x i8]* @.str9, i64 0, i64 0), i64 %2, i32 %4) #5, !dbg !669
  %5 = load %struct.InputParameters** @input, align 8, !dbg !671, !tbaa !611
  %NumberLeakyBuckets2 = getelementptr inbounds %struct.InputParameters* %5, i64 0, i32 88, !dbg !671
  %6 = load i32* %NumberLeakyBuckets2, align 4, !dbg !671, !tbaa !670
  %conv = sext i32 %6 to i64, !dbg !671
  tail call void @llvm.dbg.value(metadata !{i64 %conv}, i64 0, metadata !110), !dbg !671
  tail call void @llvm.dbg.value(metadata !672, i64 0, metadata !111), !dbg !673
  %call4 = tail call noalias i8* @calloc(i64 %conv, i64 8) #5, !dbg !674
  %7 = bitcast i8* %call4 to i64*, !dbg !674
  tail call void @llvm.dbg.value(metadata !{i64* %7}, i64 0, metadata !121), !dbg !674
  %tobool5 = icmp eq i8* %call4, null, !dbg !675
  br i1 %tobool5, label %if.then6, label %if.end7, !dbg !675

if.then6:                                         ; preds = %if.end
  tail call void @no_mem_exit(i8* getelementptr inbounds ([18 x i8]* @.str11, i64 0, i64 0)) #5, !dbg !676
  br label %if.end7, !dbg !676

if.end7:                                          ; preds = %if.end, %if.then6
  %call8 = tail call noalias i8* @calloc(i64 %conv, i64 8) #5, !dbg !677
  %8 = bitcast i8* %call8 to i64*, !dbg !677
  tail call void @llvm.dbg.value(metadata !{i64* %8}, i64 0, metadata !122), !dbg !677
  %tobool9 = icmp eq i8* %call8, null, !dbg !678
  br i1 %tobool9, label %if.then10, label %if.end11, !dbg !678

if.then10:                                        ; preds = %if.end7
  tail call void @no_mem_exit(i8* getelementptr inbounds ([18 x i8]* @.str12, i64 0, i64 0)) #5, !dbg !679
  br label %if.end11, !dbg !679

if.end11:                                         ; preds = %if.end7, %if.then10
  %call12 = tail call noalias i8* @calloc(i64 %conv, i64 8) #5, !dbg !680
  %9 = bitcast i8* %call12 to i64*, !dbg !680
  tail call void @llvm.dbg.value(metadata !{i64* %9}, i64 0, metadata !123), !dbg !680
  %tobool13 = icmp eq i8* %call12, null, !dbg !681
  br i1 %tobool13, label %if.then14, label %for.cond.preheader, !dbg !681

if.then14:                                        ; preds = %if.end11
  tail call void @no_mem_exit(i8* getelementptr inbounds ([18 x i8]* @.str13, i64 0, i64 0)) #5, !dbg !682
  br label %for.cond.preheader, !dbg !682

for.cond.preheader:                               ; preds = %if.end11, %if.then14
  %10 = load i64* @total_frame_buffer, align 8, !dbg !683, !tbaa !626
  %cmp236 = icmp eq i64 %10, 0, !dbg !683
  br i1 %cmp236, label %for.end, label %for.body, !dbg !683

for.body:                                         ; preds = %for.cond.preheader, %for.body
  %TotalRate.0238 = phi i64 [ %add17, %for.body ], [ 0, %for.cond.preheader ]
  %iFrame.0237 = phi i64 [ %inc, %for.body ], [ 0, %for.cond.preheader ]
  %arrayidx = getelementptr inbounds [10000 x i64]* @Bit_Buffer, i64 0, i64 %iFrame.0237, !dbg !685
  %11 = load i64* %arrayidx, align 8, !dbg !685, !tbaa !626
  %add17 = add i64 %11, %TotalRate.0238, !dbg !685
  tail call void @llvm.dbg.value(metadata !{i64 %add17}, i64 0, metadata !109), !dbg !685
  %inc = add i64 %iFrame.0237, 1, !dbg !683
  tail call void @llvm.dbg.value(metadata !{i64 %inc}, i64 0, metadata !115), !dbg !683
  %cmp = icmp ult i64 %inc, %10, !dbg !683
  br i1 %cmp, label %for.body, label %for.cond.for.end_crit_edge, !dbg !683

for.cond.for.end_crit_edge:                       ; preds = %for.body
  %phitmp = uitofp i64 %add17 to float, !dbg !683
  %phitmp241 = uitofp i64 %10 to float, !dbg !683
  br label %for.end, !dbg !683

for.end:                                          ; preds = %for.cond.preheader, %for.cond.for.end_crit_edge
  %.lcssa = phi float [ %phitmp241, %for.cond.for.end_crit_edge ], [ 0.000000e+00, %for.cond.preheader ]
  %TotalRate.0.lcssa = phi float [ %phitmp, %for.cond.for.end_crit_edge ], [ 0.000000e+00, %for.cond.preheader ]
  %div = fdiv float %TotalRate.0.lcssa, %.lcssa, !dbg !687
  %conv20 = fptoui float %div to i64, !dbg !687
  tail call void @llvm.dbg.value(metadata !{i64 %conv20}, i64 0, metadata !108), !dbg !687
  %call21 = tail call i32 @get_LeakyBucketRate(i64 %conv, i64* %7) #6, !dbg !688
  %cmp22 = icmp eq i32 %call21, 1, !dbg !688
  br i1 %cmp22, label %if.end55, label %for.cond25.preheader, !dbg !688

for.cond25.preheader:                             ; preds = %for.end
  %cmp26234 = icmp eq i32 %6, 0, !dbg !689
  br i1 %cmp26234, label %if.end55.thread, label %for.body28.lr.ph, !dbg !689

if.end55.thread:                                  ; preds = %for.cond25.preheader
  tail call void @Sort(i64 %conv, i64* %7) #6, !dbg !692
  tail call void @llvm.dbg.value(metadata !{i64 %mul56}, i64 0, metadata !117), !dbg !693
  tail call void @llvm.dbg.value(metadata !643, i64 0, metadata !114), !dbg !694
  br label %for.end136, !dbg !694

for.body28.lr.ph:                                 ; preds = %for.cond25.preheader
  %conv32 = uitofp i64 %conv20 to float, !dbg !696
  %12 = load %struct.ImageParameters** @img, align 8, !dbg !696, !tbaa !611
  %framerate = getelementptr inbounds %struct.ImageParameters* %12, i64 0, i32 12, !dbg !696
  %13 = load %struct.InputParameters** @input, align 8, !dbg !696, !tbaa !611
  %jumpd = getelementptr inbounds %struct.InputParameters* %13, i64 0, i32 5, !dbg !696
  %div40 = lshr i64 %conv20, 2, !dbg !698
  %conv41 = uitofp i64 %div40 to float, !dbg !698
  br label %for.body28, !dbg !689

for.body28:                                       ; preds = %for.body28.lr.ph, %for.inc52
  %iBucket.0235 = phi i64 [ 0, %for.body28.lr.ph ], [ %inc53, %for.inc52 ]
  %cmp29 = icmp eq i64 %iBucket.0235, 0, !dbg !699
  br i1 %cmp29, label %if.then31, label %if.else, !dbg !699

if.then31:                                        ; preds = %for.body28
  %14 = load float* %framerate, align 4, !dbg !696, !tbaa !700
  %mul = fmul float %conv32, %14, !dbg !696
  %conv33 = fptoui float %mul to i64, !dbg !696
  %15 = load i32* %jumpd, align 4, !dbg !696, !tbaa !670
  %add34 = add nsw i32 %15, 1, !dbg !696
  %conv35 = sext i32 %add34 to i64, !dbg !696
  %div36 = udiv i64 %conv33, %conv35, !dbg !696
  store i64 %div36, i64* %7, align 8, !dbg !696, !tbaa !626
  br label %for.inc52, !dbg !696

if.else:                                          ; preds = %for.body28
  %sub = add i64 %iBucket.0235, -1, !dbg !698
  %arrayidx38 = getelementptr inbounds i64* %7, i64 %sub, !dbg !698
  %16 = load i64* %arrayidx38, align 8, !dbg !698, !tbaa !626
  %conv39 = uitofp i64 %16 to float, !dbg !698
  %17 = load float* %framerate, align 4, !dbg !698, !tbaa !700
  %mul43 = fmul float %conv41, %17, !dbg !698
  %18 = load i32* %jumpd, align 4, !dbg !698, !tbaa !670
  %add45 = add nsw i32 %18, 1, !dbg !698
  %conv46 = sitofp i32 %add45 to float, !dbg !698
  %div47 = fdiv float %mul43, %conv46, !dbg !698
  %add48 = fadd float %conv39, %div47, !dbg !698
  %conv49 = fptoui float %add48 to i64, !dbg !698
  %arrayidx50 = getelementptr inbounds i64* %7, i64 %iBucket.0235, !dbg !698
  store i64 %conv49, i64* %arrayidx50, align 8, !dbg !698, !tbaa !626
  br label %for.inc52

for.inc52:                                        ; preds = %if.then31, %if.else
  %inc53 = add i64 %iBucket.0235, 1, !dbg !689
  tail call void @llvm.dbg.value(metadata !{i64 %inc53}, i64 0, metadata !114), !dbg !689
  %cmp26 = icmp ult i64 %inc53, %conv, !dbg !689
  br i1 %cmp26, label %for.body28, label %if.end55, !dbg !689

if.end55:                                         ; preds = %for.inc52, %for.end
  tail call void @Sort(i64 %conv, i64* %7) #6, !dbg !692
  %mul56 = mul i64 %conv20, 20, !dbg !693
  tail call void @llvm.dbg.value(metadata !{i64 %mul56}, i64 0, metadata !117), !dbg !693
  tail call void @llvm.dbg.value(metadata !643, i64 0, metadata !114), !dbg !694
  %cmp58231 = icmp eq i32 %6, 0, !dbg !694
  br i1 %cmp58231, label %for.end136, label %for.body60.lr.ph, !dbg !694

for.body60.lr.ph:                                 ; preds = %if.end55
  %19 = load %struct.InputParameters** @input, align 8, !dbg !701, !tbaa !611
  %jumpd62 = getelementptr inbounds %struct.InputParameters* %19, i64 0, i32 5, !dbg !701
  %20 = load i32* %jumpd62, align 4, !dbg !701, !tbaa !670
  %add63 = add nsw i32 %20, 1, !dbg !701
  %conv64 = sext i32 %add63 to i64, !dbg !701
  %21 = load %struct.ImageParameters** @img, align 8, !dbg !701, !tbaa !611
  %framerate67 = getelementptr inbounds %struct.ImageParameters* %21, i64 0, i32 12, !dbg !701
  %22 = load float* %framerate67, align 4, !dbg !701, !tbaa !700
  %23 = load i64* @total_frame_buffer, align 8, !dbg !703, !tbaa !626
  %cmp72226 = icmp eq i64 %23, 0, !dbg !703
  %24 = load i64* getelementptr inbounds ([10000 x i64]* @Bit_Buffer, i64 0, i64 0), align 16, !dbg !705, !tbaa !626
  br label %for.body60, !dbg !694

for.body60:                                       ; preds = %for.body60.lr.ph, %for.end131
  %iBucket.1233 = phi i64 [ 0, %for.body60.lr.ph ], [ %inc135, %for.end131 ]
  %FrameIndex.0232 = phi i64 [ 0, %for.body60.lr.ph ], [ %FrameIndex.1.lcssa, %for.end131 ]
  %arrayidx61 = getelementptr inbounds i64* %7, i64 %iBucket.1233, !dbg !701
  %25 = load i64* %arrayidx61, align 8, !dbg !701, !tbaa !626
  %mul65 = mul i64 %conv64, %25, !dbg !701
  %conv66 = uitofp i64 %mul65 to float, !dbg !701
  %div68 = fdiv float %conv66, %22, !dbg !701
  %conv69 = fptosi float %div68 to i64, !dbg !701
  tail call void @llvm.dbg.value(metadata !{i64 %conv69}, i64 0, metadata !120), !dbg !701
  tail call void @llvm.dbg.value(metadata !{i64 %mul56}, i64 0, metadata !119), !dbg !706
  tail call void @llvm.dbg.value(metadata !{i64 %mul56}, i64 0, metadata !113), !dbg !707
  tail call void @llvm.dbg.value(metadata !643, i64 0, metadata !115), !dbg !703
  br i1 %cmp72226, label %for.end99, label %for.body74, !dbg !703

for.body74:                                       ; preds = %for.body60, %for.body74.for.body74_crit_edge
  %26 = phi i64 [ %storemerge225, %for.body74.for.body74_crit_edge ], [ %mul56, %for.body60 ], !dbg !708
  %minB.0229 = phi i64 [ %sub77.minB.0, %for.body74.for.body74_crit_edge ], [ %mul56, %for.body60 ]
  %iFrame.1228 = phi i64 [ %add87, %for.body74.for.body74_crit_edge ], [ 0, %for.body60 ]
  %FrameIndex.1227 = phi i64 [ %iFrame.1.FrameIndex.1, %for.body74.for.body74_crit_edge ], [ %FrameIndex.0232, %for.body60 ]
  %arrayidx76 = getelementptr inbounds [10000 x i64]* @Bit_Buffer, i64 0, i64 %iFrame.1228, !dbg !708
  %27 = load i64* %arrayidx76, align 8, !dbg !708, !tbaa !626
  %sub77 = sub nsw i64 %26, %27, !dbg !708
  %cmp80 = icmp slt i64 %sub77, %minB.0229, !dbg !710
  tail call void @llvm.dbg.value(metadata !{i64 %sub77}, i64 0, metadata !113), !dbg !711
  tail call void @llvm.dbg.value(metadata !{i64 %iFrame.1228}, i64 0, metadata !116), !dbg !713
  %iFrame.1.FrameIndex.1 = select i1 %cmp80, i64 %iFrame.1228, i64 %FrameIndex.1227, !dbg !710
  %sub77.minB.0 = select i1 %cmp80, i64 %sub77, i64 %minB.0229, !dbg !710
  %add86 = add nsw i64 %sub77, %conv69, !dbg !714
  %add87 = add i64 %iFrame.1228, 1, !dbg !714
  tail call void @llvm.dbg.value(metadata !{i64 %add87}, i64 0, metadata !115), !dbg !703
  %exitcond = icmp eq i64 %add87, %23, !dbg !703
  br i1 %exitcond, label %for.end99, label %for.body74.for.body74_crit_edge, !dbg !703

for.body74.for.body74_crit_edge:                  ; preds = %for.body74
  %cmp91 = icmp sgt i64 %add86, %mul56, !dbg !715
  %storemerge225 = select i1 %cmp91, i64 %mul56, i64 %add86, !dbg !715
  br label %for.body74, !dbg !703

for.end99:                                        ; preds = %for.body74, %for.body60
  %minB.0.lcssa = phi i64 [ %mul56, %for.body60 ], [ %sub77.minB.0, %for.body74 ]
  %FrameIndex.1.lcssa = phi i64 [ %FrameIndex.0232, %for.body60 ], [ %iFrame.1.FrameIndex.1, %for.body74 ]
  %sub100 = sub nsw i64 %mul56, %minB.0.lcssa, !dbg !716
  tail call void @llvm.dbg.value(metadata !{i64 %sub100}, i64 0, metadata !118), !dbg !716
  tail call void @llvm.dbg.value(metadata !{i64 %24}, i64 0, metadata !119), !dbg !705
  tail call void @llvm.dbg.value(metadata !643, i64 0, metadata !115), !dbg !717
  %add103 = add i64 %FrameIndex.1.lcssa, 1, !dbg !717
  br label %for.cond102, !dbg !717

for.cond102:                                      ; preds = %for.body106, %for.end99
  %28 = phi i64 [ %24, %for.end99 ], [ %add120, %for.body106 ]
  %InitFullness.0 = phi i64 [ %24, %for.end99 ], [ %sub116.InitFullness.0, %for.body106 ]
  %iFrame.2 = phi i64 [ 0, %for.end99 ], [ %add121, %for.body106 ]
  %cmp104 = icmp ult i64 %iFrame.2, %add103, !dbg !717
  br i1 %cmp104, label %for.body106, label %for.end131, !dbg !717

for.body106:                                      ; preds = %for.cond102
  %arrayidx108 = getelementptr inbounds [10000 x i64]* @Bit_Buffer, i64 0, i64 %iFrame.2, !dbg !719
  %29 = load i64* %arrayidx108, align 8, !dbg !719, !tbaa !626
  %sub109 = sub nsw i64 %28, %29, !dbg !719
  %cmp112 = icmp slt i64 %sub109, 0, !dbg !721
  %.sub109 = select i1 %cmp112, i64 0, i64 %sub109, !dbg !721
  %sub116 = select i1 %cmp112, i64 %sub109, i64 0, !dbg !721
  %sub116.InitFullness.0 = sub nsw i64 %InitFullness.0, %sub116, !dbg !721
  %add120 = add nsw i64 %.sub109, %conv69, !dbg !722
  %add121 = add i64 %iFrame.2, 1, !dbg !722
  %cmp125 = icmp sgt i64 %add120, %sub100, !dbg !723
  br i1 %cmp125, label %for.end131, label %for.cond102, !dbg !723

for.end131:                                       ; preds = %for.body106, %for.cond102
  %InitFullness.2 = phi i64 [ %sub116.InitFullness.0, %for.body106 ], [ %InitFullness.0, %for.cond102 ]
  %arrayidx132 = getelementptr inbounds i64* %8, i64 %iBucket.1233, !dbg !724
  store i64 %sub100, i64* %arrayidx132, align 8, !dbg !724, !tbaa !626
  %arrayidx133 = getelementptr inbounds i64* %9, i64 %iBucket.1233, !dbg !725
  store i64 %InitFullness.2, i64* %arrayidx133, align 8, !dbg !725, !tbaa !626
  %inc135 = add i64 %iBucket.1233, 1, !dbg !694
  tail call void @llvm.dbg.value(metadata !{i64 %inc135}, i64 0, metadata !114), !dbg !694
  %cmp58 = icmp ult i64 %inc135, %conv, !dbg !694
  br i1 %cmp58, label %for.body60, label %for.end136, !dbg !694

for.end136:                                       ; preds = %for.end131, %if.end55.thread, %if.end55
  tail call void @write_buffer(i64 %conv, i64* %7, i64* %8, i64* %9) #6, !dbg !726
  tail call void @free(i8* %call4) #5, !dbg !727
  tail call void @free(i8* %call8) #5, !dbg !728
  tail call void @free(i8* %call12) #5, !dbg !729
  ret void, !dbg !730
}
