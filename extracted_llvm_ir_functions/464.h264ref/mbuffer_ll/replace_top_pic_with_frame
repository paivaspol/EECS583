define void @replace_top_pic_with_frame(%struct.storable_picture* %p) #1 {
entry:
  %0 = load %struct.ImageParameters** @img, align 8, !tbaa !0
  %nal_reference_idc = getelementptr inbounds %struct.ImageParameters* %0, i64 0, i32 113
  %1 = load i32* %nal_reference_idc, align 4, !tbaa !3
  %cmp = icmp ne i32 %1, 0
  %conv = zext i1 %cmp to i32
  %used_for_reference = getelementptr inbounds %struct.storable_picture* %p, i64 0, i32 15
  store i32 %conv, i32* %used_for_reference, align 4, !tbaa !3
  br i1 %cmp, label %if.then, label %for.cond.preheader

if.then:                                          ; preds = %entry
  tail call void @UnifiedOneForthPix(%struct.storable_picture* %p) #6
  br label %for.cond.preheader

for.cond.preheader:                               ; preds = %if.then, %entry
  %2 = load i32* getelementptr inbounds (%struct.decoded_picture_buffer* @dpb, i64 0, i32 4), align 4, !tbaa !3
  %cmp244 = icmp eq i32 %2, 0
  br i1 %cmp244, label %if.then16, label %for.body.lr.ph

for.body.lr.ph:                                   ; preds = %for.cond.preheader
  %3 = load %struct.frame_store*** getelementptr inbounds (%struct.decoded_picture_buffer* @dpb, i64 0, i32 0), align 8, !tbaa !0
  %4 = load %struct.ImageParameters** @img, align 8, !tbaa !0
  %frame_num4 = getelementptr inbounds %struct.ImageParameters* %4, i64 0, i32 105
  %5 = load i32* %frame_num4, align 4, !tbaa !3
  br label %for.body

for.body:                                         ; preds = %for.body.lr.ph, %for.inc
  %indvars.iv = phi i64 [ 0, %for.body.lr.ph ], [ %indvars.iv.next, %for.inc ]
  %arrayidx = getelementptr inbounds %struct.frame_store** %3, i64 %indvars.iv
  %6 = load %struct.frame_store** %arrayidx, align 8, !tbaa !0
  %frame_num = getelementptr inbounds %struct.frame_store* %6, i64 0, i32 5
  %7 = load i32* %frame_num, align 4, !tbaa !3
  %cmp5 = icmp eq i32 %7, %5
  br i1 %cmp5, label %land.lhs.true, label %for.inc

land.lhs.true:                                    ; preds = %for.body
  %is_used = getelementptr inbounds %struct.frame_store* %6, i64 0, i32 0
  %8 = load i32* %is_used, align 4, !tbaa !3
  %cmp9 = icmp eq i32 %8, 1
  br i1 %cmp9, label %if.end17, label %for.inc

for.inc:                                          ; preds = %for.body, %land.lhs.true
  %indvars.iv.next = add i64 %indvars.iv, 1
  %9 = trunc i64 %indvars.iv.next to i32
  %cmp2 = icmp ult i32 %9, %2
  br i1 %cmp2, label %for.body, label %if.then16

if.then16:                                        ; preds = %for.inc, %for.cond.preheader
  tail call void @error(i8* getelementptr inbounds ([80 x i8]* @.str14, i64 0, i64 0), i32 500) #6
  br label %if.end17

if.end17:                                         ; preds = %land.lhs.true, %if.then16
  %fs.043 = phi %struct.frame_store* [ null, %if.then16 ], [ %6, %land.lhs.true ]
  %top_field = getelementptr inbounds %struct.frame_store* %fs.043, i64 0, i32 11
  %10 = load %struct.storable_picture** %top_field, align 8, !tbaa !0
  tail call void @free_storable_picture(%struct.storable_picture* %10) #7
  store %struct.storable_picture* null, %struct.storable_picture** %top_field, align 8, !tbaa !0
  %frame = getelementptr inbounds %struct.frame_store* %fs.043, i64 0, i32 10
  store %struct.storable_picture* %p, %struct.storable_picture** %frame, align 8, !tbaa !0
  %is_used19 = getelementptr inbounds %struct.frame_store* %fs.043, i64 0, i32 0
  store i32 3, i32* %is_used19, align 4, !tbaa !3
  %11 = load i32* %used_for_reference, align 4, !tbaa !3
  %tobool21 = icmp eq i32 %11, 0
  br i1 %tobool21, label %if.end27, label %if.then22

if.then22:                                        ; preds = %if.end17
  %is_reference = getelementptr inbounds %struct.frame_store* %fs.043, i64 0, i32 1
  store i32 3, i32* %is_reference, align 4, !tbaa !3
  %is_long_term = getelementptr inbounds %struct.storable_picture* %p, i64 0, i32 14
  %12 = load i32* %is_long_term, align 4, !tbaa !3
  %tobool23 = icmp eq i32 %12, 0
  br i1 %tobool23, label %if.end27, label %if.then24

if.then24:                                        ; preds = %if.then22
  %is_long_term25 = getelementptr inbounds %struct.frame_store* %fs.043, i64 0, i32 2
  store i32 3, i32* %is_long_term25, align 4, !tbaa !3
  br label %if.end27

if.end27:                                         ; preds = %if.then22, %if.end17, %if.then24
  tail call void @dpb_split_field(%struct.frame_store* %fs.043) #7
  tail call void @update_ref_list() #7
  tail call void @update_ltref_list() #7
  ret void
}
